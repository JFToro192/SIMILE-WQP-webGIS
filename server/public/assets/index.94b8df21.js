import{C as _,O as X,a as ne,T as E,M as re,d as le,S as oe,V as ce,W as q,b as z,L as W,c as de,o as p,e as m,f as g,t as u,g as r,F as B,r as D,p as x,h as C,n as M,i as K,j,w as O,k as ue,v as pe,l as me,m as v,q as w,s as _e,u as ge,x as ye,y as he,z as ve}from"./vendor.eedb9b49.js";const Ae=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerpolicy&&(l.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?l.credentials="include":e.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(e){if(e.ep)return;e.ep=!0;const l=s(e);fetch(e.href,l)}};Ae();var fe="/assets/assev_simile.d3f83cf6.png";function be(){const t="."+this.element.classList[0],a="."+t.split("-")[1]+"-item",s=$(t);s.hasClass("active")?($(`${a}`).slice(0).hide(),s.removeClass("active")):($(`${a}`).slice(0).show(),s.addClass("active"))}function P(){const t="."+this.element.classList[0],a="."+t.split("-")[1]+"-panel",s=$(t),n=$(a);n.hasClass("active")?(n.hide(),s.removeClass("active"),n.removeClass("active")):(n.show(),s.addClass("active"),n.addClass("active"))}class we extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-list"></i>';const e=document.createElement("div");e.className="show-burger ol-unselectable ol-control control-bar active",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",be.bind(this),!1)}}class Le extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-stack"></i>',n.title="layers panel";const e=document.createElement("div");e.className="show-layer ol-unselectable ol-control control-bar burger-item",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",P.bind(this),!1)}}class xe extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-info-square"></i>',n.title="metadata panel";const e=document.createElement("div");e.className="show-metadata ol-unselectable ol-control control-bar burger-item",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",P.bind(this),!1)}}class Ce extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-clock-history"></i>',n.title="time panel";const e=document.createElement("div");e.className="show-time ol-unselectable ol-control control-bar burger-item",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",P.bind(this),!1)}}class Se extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-map"></i>',n.title="basemaps";const e=document.createElement("div");e.className="show-basemap ol-unselectable ol-control control-bar burger-item",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",P.bind(this),!1)}}class Ie extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-file-earmark-easel"></i>',n.title="webgis guide";const e=document.createElement("div");e.className="show-slide ol-unselectable ol-control control-bar burger-item",e.appendChild(n);super({element:e,target:s.target});e.addEventListener("click",P.bind(this),!1)}}class Ee extends _{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<a href="https://www.geonode.eo.simile.polimi.it/"><i class="bi bi-people-fill"></i></a>',n.src=n.title="GeoNode";const e=document.createElement("div");e.className="show-geonode ol-unselectable ol-control control-bar",e.appendChild(n);super({element:e,target:s.target})}}class Be extends _{constructor(a){const s=a||{},n=document.createElement("div"),e=document.createElement("a");e.href="https://www.progetti.interreg-italiasvizzera.eu/it/b/78/sistemainformativoperilmonitoraggiointegratodeilaghiinsubriciedeiloroe";const l=document.createElement("img");l.src=fe,l.alt="logo-simile-interreg",e.appendChild(l),n.appendChild(e);const i=document.createElement("div");i.className="project-logo ol-unselectable ol-control",i.appendChild(n);super({element:i,target:s.target})}}const De=new X,Me=new ne({layers:[new E({source:De})]});function Pe(){return new re({target:"map",controls:le().extend([new oe,Me,new we,new Le,new xe,new Ce,new Se,new Ie,new Be,new Ee]),view:new ce({center:[994904.36016,5775887605341e-6],zoom:10})})}new _({element:document.getElementById("layerPanel")});new _({element:document.getElementById("metadataPanel")});new _({element:document.getElementById("timePanel")});new _({element:document.getElementById("basemapPanel")});new _({element:document.getElementById("plotPanel")});new _({element:document.getElementById("slidePanel")});new _({element:document.getElementById("popup")});new q;function Q(t,a,s,n){return new E({source:new de({url:a,params:{LAYERS:t,TILED:!0,STYLES:n},serverType:"geoserver"}),visible:!1,opacity:s})}function R(t,a){return t[a.name]={},t[a.name].workspace=a.workspace,t[a.name].typology=a.typology,t[a.name].crs=a.crs,t[a.name].sensor=a.sensor,t[a.name].timeComplete=[a.timeComplete],t[a.name].timeFormatted=[a.timeFormatted],t[a.name].level=a.level,t[a.name].layer=[a.layer],t}function Ve(t,a,s){let n=Object.keys(a),e={};return e.static={},e.time={},e.basemap={},t.forEach(l=>{let i={},o=l.Name.split(":");if(i.workspace=o[0],i.name=o[1].split("_").slice(0,3).join("_"),i.sensor=o[1].split("_")[0],i.typology=o[1].split("_")[1],i.crs=o[1].split("_")[2],o[1].split("_")[3]!=null){i.timeComplete=o[1].split("_")[3];let d=o[1].split("_")[3].split("T")[0];i.timeFormatted=d.slice(0,4)+"-"+d.slice(4,6)+"-"+d.slice(6,8)}else i.timeComplete=void 0,i.timeFormatted=void 0;i.level=o[1].split("_")[4];let c="";n.includes(i.typology)&&(c=i.typology.toLowerCase()),i.layer=Q(l.Name,s,.5,c),i.timeComplete!=null?i.name in e.time?(i.layer=Q(l.Name,s,1,c),i.layer.title="time",i.layer.date=i.timeFormatted,i.layer.name=i.name,i.name.split("_")[1]=="LSWT"?i.layer.units="[\xB0C]":i.name.split("_")[1]=="CHL"?i.layer.units="[mg/m3]":i.name.split("_")[1]=="TSM"&&(i.layer.units="[g/m3]"),e.time[i.name].timeComplete.push(i.timeComplete),e.time[i.name].timeFormatted.push(i.timeFormatted),e.time[i.name].layer.push(i.layer)):(i.layer=Q(l.Name,s,1),i.layer.title="time",i.layer.name=i.name,i.layer.date=i.timeFormatted,i.name.split("_")[1]=="LSWT"?i.layer.units="[\xB0C]":i.name.split("_")[1]=="CHL"?i.layer.units="[mg/m3]":i.name.split("_")[1]=="TSM"&&(i.layer.units="[g/m3]"),e.time=R(e.time,i)):e.static=R(e.static,i)}),e}function Ne(t){let a={osm:{title:"osm",layer:[new E({source:new X,visible:!0})]},terrain:{title:"terrain",source:"Stamen",layer:[new E({source:new z({layer:"terrain"}),visible:!1})]},toner:{title:"toner",source:"Stamen",layer:[new E({source:new z({layer:"toner"}),visible:!1})]}};return t.basemap=a,t}function U(t){let a={},s=[],n=[],e=[],l=[],i=[];for(let o in t)if(o=="time")for(let c in t[o]){let d=t[o][c].layer;i.push(new W({layers:d,visible:!0,opacity:.5}))}else{for(let c in t[o])if(o=="basemap"){let d=t[o][c].layer[0];d.title="basemap",s.push(d)}else if(o=="static"){let d=t[o][c].layer[0];d.title="static",n.push(d)}l[0]=new W({layers:n,visible:!0,opacity:1}),e[0]=new W({layers:s,visible:!0,opacity:1})}return a.basemap=e,a.static=l,a.time=i,a}function ke(t){t.forEach(a=>{a.then(s=>{})})}var y=(t,a)=>{const s=t.__vccOpts||t;for(const[n,e]of a)s[n]=e;return s};const Te={name:"Layer",props:{child_msg:{type:String,default:"Layer Panel"},layer_list:{type:Object}},data(){return{}},methods:{setLayerVisible(t,a,s,n,e){this.$emit("setLayerVisible",{nGroup:a,index:s}),t.target.checked&&this.setLayerMetadata(n,e)},setLayerOpacity(t,a,s){let n=t.target.value;this.$emit("setLayerOpacity",{opacity:n,nGroup:a,index:s})},setLayerMetadata(t,a){this.$emit("setLayerMetadata",{layerType:t,layerName:a})}}},L=t=>(x("data-v-3b7d1851"),t=t(),C(),t),Ge={id:"layerPanel",class:"layer-panel ol-unselectable ol-control"},We=L(()=>r("h6",{class:"static-layers-title"},[r("i",{class:"bi bi-arrow-right"}),g("Static Layers")],-1)),je={class:"static-layers active",id:"staticLayers"},Oe={class:"layer-items"},Qe=["onChange"],Ye={class:"title-layer"},$e=["title"],He=L(()=>r("div",{class:"dwnld-layer"},[r("i",{class:"bi bi-box-arrow-down"})],-1)),Fe=["onClick"],Je=L(()=>r("i",{class:"bi bi-info-square"},null,-1)),Xe=[Je],qe=L(()=>r("div",{class:"opct-layer"},[r("i",{class:"bi bi-brightness-high"})],-1)),ze={class:"opct-range-layer"},Ke=["onChange"],Re=L(()=>r("h6",{class:"time-series-layers-title"},[r("i",{class:"bi bi-arrow-right"}),g("Time Series Layers")],-1)),Ue={class:"time-series-layers active",id:"timeSeriesLayers"},Ze={class:"layer-items"},et=["onChange"],tt={class:"title-layer"},st=["title"],at=L(()=>r("div",{class:"dwnld-layer"},[r("i",{class:"bi bi-box-arrow-down"})],-1)),it=["onClick"],nt=L(()=>r("i",{class:"bi bi-info-square"},null,-1)),rt=[nt],lt=L(()=>r("div",{class:"opct-layer"},[r("i",{class:"bi bi-brightness-high"})],-1)),ot={class:"opct-range-layer"},ct=["onChange"];function dt(t,a,s,n,e,l){return p(),m("div",Ge,[g(u(s.child_msg)+" ",1),We,r("div",je,[(p(!0),m(B,null,D(s.layer_list.static,(i,o,c)=>(p(),m("div",{class:"static-layer layer-list",key:i.static},[r("div",Oe,[r("div",{class:M("chckbx-layer layer-static-"+c)},[r("input",{type:"checkbox",title:"set visible",name:"",id:"",class:M("layer-static-"+c),onChange:d=>l.setLayerVisible(d,1,c,"static",{key:o})},null,42,Qe)],2),r("div",Ye,[r("p",{title:o},u(o),9,$e)]),He,r("div",{class:"info-layer",onClick:d=>l.setLayerMetadata("static",{key:o})},Xe,8,Fe),qe,r("div",ze,[r("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.5",onChange:d=>l.setLayerOpacity(d,1,c)},null,40,Ke)])])]))),128))]),Re,r("div",Ue,[(p(!0),m(B,null,D(s.layer_list.time,(i,o,c)=>(p(),m("div",{class:"time-series-layer layer-list",key:i.time},[r("div",Ze,[r("div",{class:M("chckbx-layer"+c)},[r("input",{type:"checkbox",title:"set visible",name:"",id:"",class:M("layer-timeSeries-"+c),onChange:d=>l.setLayerVisible(d,2,c,"time",{key:o})},null,42,et)],2),r("div",tt,[r("p",{title:o},u(o),9,st)]),at,r("div",{class:"info-layer",onClick:d=>l.setLayerMetadata("time",{key:o})},rt,8,it),lt,r("div",ot,[r("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.5",onChange:d=>l.setLayerOpacity(d,2,c)},null,40,ct)])])]))),128))])])}var ut=y(Te,[["render",dt],["__scopeId","data-v-3b7d1851"]]);const pt={name:"Layer",props:{child_msg:{type:String,required:!0,default:"Metadata Panel"},title:{type:String,required:!0,default:"Title"},abstract:{type:String,required:!0,default:"Select a layer"},typology:{type:String,required:!0,default:"N/A"},units:{type:String,required:!0,default:"N/A"},crs:{type:String,required:!0,default:"N/A"},to:{type:String,required:!0,default:"N/A"},tf:{type:String,required:!0,default:"N/A"},legend:{type:String,required:!0,default:"N/A"}},data(){return{}}},A=t=>(x("data-v-cf4a443c"),t=t(),C(),t),mt={id:"metadataPanel",class:"metadata-panel ol-unselectable ol-control"},_t={class:"panel-title"},gt={class:"meta-title"},yt={class:"meta-abstract"},ht=A(()=>r("strong",null,"Abstract:",-1)),vt={class:"meta-info"},At={class:"meta-details"},ft={class:"meta-details-typology"},bt=A(()=>r("strong",null,"Typology:",-1)),wt={class:"meta-details-units"},Lt=A(()=>r("strong",null,"Units:",-1)),xt={class:"meta-details-crs"},Ct=A(()=>r("strong",null,"CRS:",-1)),St={class:"meta-details-tstart"},It=A(()=>r("strong",null,"Time Start:",-1)),Et=A(()=>r("br",null,null,-1)),Bt={class:"meta-details-tend"},Dt=A(()=>r("strong",null,"Time end:",-1)),Mt=A(()=>r("br",null,null,-1)),Pt={class:"meta-legend"},Vt=A(()=>r("div",null,[r("strong",null,"Legend:")],-1)),Nt={class:"meta-legend-image"},kt=["src"];function Tt(t,a,s,n,e,l){return p(),m("div",mt,[r("div",_t,u(s.child_msg),1),r("div",gt,[r("h6",null,u(s.title),1)]),r("div",yt,[ht,g(u(s.abstract),1)]),r("div",vt,[r("div",At,[r("div",ft,[bt,g(u(s.typology),1)]),r("div",wt,[Lt,g(" ["+u(s.units)+"]",1)]),r("div",xt,[Ct,g(u(s.crs),1)]),r("div",St,[It,Et,g(u(s.to),1)]),r("div",Bt,[Dt,Mt,g(u(s.tf),1)])]),r("div",Pt,[Vt,r("div",Nt,[r("img",{src:s.legend,alt:""},null,8,kt)])])])])}var Gt=y(pt,[["render",Tt],["__scopeId","data-v-cf4a443c"]]);const Wt={name:"Time",props:{child_msg:{type:String,default:"Time Panel"},title:{type:String,required:!0,default:"Select Layer"},datesList:{type:Object,required:!0,default:()=>({"0":"Select TS"})},datesListLength:{type:String,required:!0},currentDate:{type:String,required:!0},currentDateIndex:{type:Number,required:!0},currentGroup:{type:Number,required:!0}},data(){return{}},methods:{updateLayerSlider(t){console.log(t);let a=t.target.value,s=parseInt(a),n=this.currentGroup+2,e=document.getElementById("dropdownDate");e.selectedIndex=a,this.cDate=this.datesList[a],this.cDateIndex=a,this.$emit("updateLayerSlider",{nGroup:n,emitDate:s})},updateLayerDropdown(t){let a=t.target.value,s=parseInt(a),n=this.currentGroup+2,e=document.getElementById("sliderDate");e.value=a,this.cDate=this.datesList[a],this.cDateIndex=a,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:s})},stepBackwards(){let t=document.getElementById("sliderDate").value,a=t-1,s=t-1,n=this.currentGroup+2;t-1>=0?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:a})):alert("There are no previous maps for the current layer")},stepForwards(){let t=document.getElementById("dropdownDate").value,a=Number(t)+1,s=Number(t)+1,n=this.currentGroup+2;Number(t)+1<=this.datesListLength-1?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:a})):alert("There are no later maps for the current layer")}}},Z=t=>(x("data-v-0b528842"),t=t(),C(),t),jt={id:"timePanel",class:"time-panel ol-unselectable ol-control"},Ot={class:"time-container"},Qt={class:"time-header"},Yt={class:"time-controls"},$t={class:"time-controls-dates"},Ht=["value","selected"],Ft={class:"time-slider"},Jt=["max","value"],Xt={id:"time-controls-backward",class:"time-controls_item ol-unselectable ol-control"},qt=Z(()=>r("i",{class:"bi bi-skip-backward-circle"},null,-1)),zt=[qt],Kt={id:"time-controls-forward",class:"time-controls_item ol-unselectable ol-control"},Rt=Z(()=>r("i",{class:"bi bi-skip-forward-circle"},null,-1)),Ut=[Rt];function Zt(t,a,s,n,e,l){return p(),m("div",jt,[r("p",null,u(s.child_msg),1),r("div",Ot,[r("div",Qt,[r("strong",null,u(s.title),1)]),r("div",Yt,[r("div",$t,[r("select",{name:"",id:"dropdownDate",onChange:a[0]||(a[0]=i=>l.updateLayerDropdown(i))},[(p(!0),m(B,null,D(s.datesList,(i,o)=>(p(),m("option",{value:o,selected:s.datesListLength,key:o},u(s.datesList[o]),9,Ht))),128))],32)]),r("div",Ft,[r("input",{type:"range",name:"",id:"sliderDate",min:"0",max:s.datesListLength-1,value:s.currentDateIndex,step:"1",onChange:a[1]||(a[1]=i=>l.updateLayerSlider(i))},null,40,Jt)]),r("div",Xt,[r("button",{class:"time-panel-control-button",onClick:a[2]||(a[2]=(...i)=>l.stepBackwards&&l.stepBackwards(...i))},zt)]),r("div",Kt,[r("button",{class:"time-panel-control-button",onClick:a[3]||(a[3]=(...i)=>l.stepForwards&&l.stepForwards(...i))},Ut)])])])])}var es=y(Wt,[["render",Zt],["__scopeId","data-v-0b528842"]]),ts="/assets/osm.d6d13acb.png",ss="/assets/terrain.d843a7bb.png",as="/assets/watercolor.8d0c5f2f.png",is="/assets/toner.19bbfbf8.png",ns="data:image/png;base64,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";const rs={name:"Basemap",props:{child_msg:{type:String,default:"Basemap Panel"},data:{type:Array},layer_list:{type:Object,require:!0}},data(){return{}},methods:{getImage(t){if(t=="osm")return ts;if(t=="terrain")return ss;if(t=="watercolor")return as;if(t=="toner")return is;if(t=="none")return ns},setLayerVisible(t,a){this.$emit("setLayerVisible",{nGroup:t,index:a})}}},ls={id:"basemapPanel",class:"basemap-panel ol-unselectable ol-control"},os={class:"basemap-container"},cs=["id","checked","onChange"],ds=["src"];function us(t,a,s,n,e,l){return p(),m("div",ls,[r("p",null,u(s.child_msg),1),r("div",os,[(p(!0),m(B,null,D(s.data,(i,o)=>(p(),m("div",{key:i.layer,class:"basemap-container_item"},[r("div",null,[r("input",{type:"radio",name:"basemap-radio",id:i.layer+"-option",class:M("basemap-option"),checked:i.active,onChange:c=>l.setLayerVisible(0,o)},null,40,cs),r("p",null,u(i.layer),1)]),r("img",{src:l.getImage(i.layer),alt:""},null,8,ds)]))),128))])])}var ps=y(rs,[["render",us],["__scopeId","data-v-26d54738"]]);const ms={name:"Plot",props:{child_msg:{type:String,default:"Plot Panel"}},data(){return{}},mounted(){var t={top:10,right:30,bottom:30,left:60},a=$(".svg-container").parent().width(),s=$(".svg-container").parent().height()-80,n=d3.select(".svg-container").append("svg").attr("width",a+t.left+t.right).attr("height",s+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.csv("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/connectedscatter.csv",function(e){return{date:d3.timeParse("%Y-%m-%d")(e.date),value:e.value}},function(e){var l=d3.scaleTime().domain(d3.extent(e,function(o){return o.date})).range([0,a]);n.append("g").attr("transform","translate(0,"+s+")").call(d3.axisBottom(l));var i=d3.scaleLinear().domain([8e3,9200]).range([s,0]);n.append("g").call(d3.axisLeft(i)),n.append("path").datum(e).attr("fill","none").attr("stroke","#69b3a2").attr("stroke-width",1.5).attr("d",d3.line().x(function(o){return l(o.date)}).y(function(o){return i(o.value)})),n.append("g").selectAll("dot").data(e).enter().append("circle").attr("cx",function(o){return l(o.date)}).attr("cy",function(o){return i(o.value)}).attr("r",5).attr("fill","#69b3a2")})}},_s=t=>(x("data-v-636acc4b"),t=t(),C(),t),gs={id:"plotPanel",class:"plot-panel ol-unselectable ol-control"},ys=_s(()=>r("div",{class:"svg-container"},null,-1));function hs(t,a,s,n,e,l){return p(),m("div",gs,[g(u(s.child_msg)+" ",1),ys])}var vs=y(ms,[["render",hs],["__scopeId","data-v-636acc4b"]]),As="/assets/i1.39c6eac4.png",fs="/assets/i2.52627267.png",bs="/assets/i3.e76ce568.png",ws="/assets/i4.df51a994.png",Ls="/assets/i5.9255129d.png",xs="/assets/i6.c99fefa1.png",Cs="/assets/i7.1425b493.png";const Ss={data(){return{}},methods:{prev(){this.$emit("prev")},next(){this.$emit("next")}}},ee=t=>(x("data-v-07c985f2"),t=t(),C(),t),Is={class:"carousel-container"},Es=ee(()=>r("i",{class:"bi bi-caret-left-fill"},null,-1)),Bs=[Es],Ds=ee(()=>r("i",{class:"bi bi-caret-right-fill"},null,-1)),Ms=[Ds];function Ps(t,a,s,n,e,l){return p(),m("div",Is,[K(t.$slots,"default",{},void 0,!0),r("button",{class:"prev",onClick:a[0]||(a[0]=(...i)=>l.prev&&l.prev(...i))},Bs),r("button",{class:"next",onClick:a[1]||(a[1]=(...i)=>l.next&&l.next(...i))},Ms)])}var Vs=y(Ss,[["render",Ps],["__scopeId","data-v-07c985f2"]]);const Ns={props:["visibleSlide","index","direction"],data(){return{}}},ks={class:"carousel-slide"};function Ts(t,a,s,n,e,l){return p(),j(me,{name:s.direction},{default:O(()=>[ue(r("div",ks,[K(t.$slots,"default",{},void 0,!0)],512),[[pe,s.visibleSlide===s.index]])]),_:3},8,["name"])}var Gs=y(Ns,[["render",Ts],["__scopeId","data-v-664b1638"]]);const Ws={name:"Slide",props:{child_msg:{type:String,default:"Slide Panel"},settings:{type:Object}},data(){return{visibleSlide:0,direction:""}},computed:{slidesLen(){return this.settings.slides.length}},methods:{prev(){this.visibleSlide<=0?this.visibleSlide=this.slidesLen-1:this.visibleSlide--,this.direction="right"},next(){this.visibleSlide>=this.slidesLen-1?this.visibleSlide=0:this.visibleSlide++,this.direction="left"},getImage(t){if(t=="i1.png")return As;if(t=="i2.png")return fs;if(t=="i3.png")return bs;if(t=="i4.png")return ws;if(t=="i5.png")return Ls;if(t=="i6.png")return xs;if(t=="i7.png")return Cs}},mounted(){},components:{CarouselContainer:Vs,CarouselSlide:Gs}},js=t=>(x("data-v-339db63c"),t=t(),C(),t),Os={id:"slidePanel",class:"slide-panel ol-unselectable ol-control",style:{display:"none"}},Qs={class:"slidepanel-show"},Ys={class:"slide-title"},$s={class:"slide-description"},Hs=["src","alt"],Fs=js(()=>r("div",{class:"slide-current"},null,-1));function Js(t,a,s,n,e,l){const i=v("carousel-slide"),o=v("carousel-container");return p(),m("div",Os,[g(u(s.child_msg)+" ",1),r("div",Qs,[w(o,{onPrev:l.prev,onNext:l.next},{default:O(()=>[(p(!0),m(B,null,D(s.settings.slides,(c,d)=>(p(),j(i,{key:c,index:d,visibleSlide:e.visibleSlide,direction:e.direction},{default:O(()=>[r("div",Ys,u(c.title),1),r("div",$s,u(c.description),1),r("img",{src:l.getImage(c.src),alt:d},null,8,Hs)]),_:2},1032,["index","visibleSlide","direction"]))),128))]),_:1},8,["onPrev","onNext"])]),Fs])}var Xs=y(Ws,[["render",Js],["__scopeId","data-v-339db63c"]]);const qs={setup(){},data:function(){return{}},props:{map:{type:Object,required:!0},title:{type:String,required:!0,default:"Select layer"},evtCoordinate:{type:String,required:!0,default:"Select layer"},pixelCoordinate:{type:String,required:!0,default:"click-on map"},pixelInfo:{type:String,required:!0,default:"N/A"},pixelUnits:{type:String,required:!0,default:"N/A"}}},zs=t=>(x("data-v-3ecc9474"),t=t(),C(),t),Ks={id:"popup",class:"ol-popup"},Rs={id:"popup-title"},Us=zs(()=>r("a",{href:"#",id:"popup-closer",class:"ol-popup-closer"},null,-1)),Zs={id:"popup-info"},ea={id:"popup-getinfo"},ta={id:"popup-coordinate"};function sa(t,a,s,n,e,l){return p(),m("div",Ks,[r("div",Rs,u(s.title),1),Us,r("div",Zs,[r("div",ea,"Value: "+u(s.pixelInfo)+" "+u(s.pixelUnits),1),r("div",ta,"Coordinates: "+u(s.pixelCoordinate),1)])])}var aa=y(qs,[["render",sa],["__scopeId","data-v-3ecc9474"]]),ia="/assets/chl_legend.60bb7d0f.png",na="/assets/tsm_legend.d3624ad5.png",ra="/assets/lswt_legend.56275681.png";const la=new q,oa={name:"WebGISContainer",data(){return{basemap_settings:this.settings.basemaps,layer_list:{},layer_groups:{},map:{},title:"Select a Layer",typology:"N/A",abstract:"N/A",to:"N/A",tf:"N/A",crs:"N/A",units:"N/A",legend:"N/A",datesList:{},currentGroup:"",currentDate:"",currentDateIndex:"",datesListLength:"",noGetinfo:0}},props:{settings:{type:Object,required:!0}},components:{layerPanel:ut,metadataPanel:Gt,timePanel:es,basemapPanel:ps,plotPanel:vs,slidePanel:Xs,popUp:aa},methods:{setLayerVisible(t){let a=t.index,s=t.nGroup;if(s==0){let n=this.map.getLayers().array_[s].values_.layers.array_;n.forEach((e,l)=>{a!=l||n.length<a?e.setVisible(!1):e.setVisible(!0)})}else if(s==1){let n=this.map.getLayers().array_[s].values_.layers.array_[a].getVisible();this.map.getLayers().array_[s].values_.layers.array_[a].setVisible(!n)}else{let e=this.map.getLayers().array_[s+a].values_.layers.array_.length-1,l=this.map.getLayers().array_[s+a].values_.layers.array_,i=0;l.forEach((o,c)=>{let d=this.map.getLayers().array_[s+a].values_.layers.array_[c].getVisible();if(o.getVisible()==!0&&c!=e)return this.map.getLayers().array_[s+a].values_.layers.array_[c].setVisible(!d),i++,!1;i==0&&c==e&&(this.map.getLayers().array_[s+a].values_.layers.array_[e].setVisible(!d),this.currentDate=o.date)})}},setLayerVisibleTS(t){let a=t.nGroup,s=t.emitDate;this.map.getLayers().array_[a].values_.layers.array_.forEach((e,l)=>{s==l?e.setVisible(!0):e.setVisible(!1)})},setLayerOpacity(t){let a=t.opacity,s=t.index,n=t.nGroup;if(n<=1)this.map.getLayers().array_[n].values_.layers.array_[s].getVisible()==!0?(this.map.getLayers().array_[n].values_.layers.array_[s].setVisible(!1),this.map.getLayers().array_[n].values_.layers.array_[s].values_.opacity=a,this.map.getLayers().array_[n].values_.layers.array_[s].setVisible(!0)):this.map.getLayers().array_[n].values_.layers.array_[s].values_.opacity=a;else{let e=this.map.getLayers().array_[n+s];e.getVisible()==!0?(e.setVisible(!1),e.values_.opacity=a,e.setVisible(!0)):e.values_.opacity=a}},setLayerMetadata(t){let a=t.layerType,s=t.layerName.key,n=this.layer_list[a][s];if(this.title=s,a=="time"){let e=n.typology,l=n.timeFormatted;this.typology=e,this.abstract=this.settings.typology[e].abstract,this.units=this.settings.typology[e].units,this.crs=n.crs,this.typology=="CHL"?this.legend=ia:this.typology=="TSM"?this.legend=na:this.legend=ra,this.to=l[0],this.tf=l[l.length-1],this.datesList=this.layer_list.time[s].timeFormatted,this.currentDate=this.datesList[Object.keys(this.datesList).length-1],this.currentDateIndex=Object.keys(this.datesList).length,this.datesListLength=Object.keys(this.datesList).length,this.currentGroup=Object.keys(this.layer_list.time).indexOf(s)}$(".metadata-panel").addClass("active"),$(".metadata-panel").css("display","block"),a=="time"&&($(".time-panel").addClass("active"),$(".time-panel").css("display","block"),$(".show-metadata").addClass("active"),$(".show-time").addClass("active"))},downloadData(){}},mounted(){const t={method:"HEAD"};this.basemap_settings=this.settings.basemaps,_e.get(this.settings.urlWMSget).then(a=>{let n=la.read(a.data).Capability.Layer.Layer,e=Ve(n,this.settings.typology,this.settings.urlWMS);Ne(e);let l=U(e);this.layer_list=e,this.layer_group=l;let i={};for(let[c,d]of Object.entries(e.time)){let f=c.split("_").splice(0,2).join("_");f in Object.keys(i)||(i[f]=d)}return this.layer_list.time=i,i=this.layer_list,{layers_groups_reduced:U(i),layers_dict_reduced:i}}).then(a=>{const s=a.layers_groups_reduced,n=a.layers_dict_reduced,e=Pe();for(let h in s)for(let S in s[h])e.addLayer(s[h][S]);this.map=e;const l=document.getElementById("popup"),i=document.getElementById("popup-title"),o=document.getElementById("popup-coordinate"),c=document.getElementById("popup-getinfo"),d=document.getElementById("popup-closer"),f=new ge({element:l,autoPan:{animation:{duration:250}}});d.onclick=function(){return f.setPosition(void 0),d.blur(),!1},e.addControl(f);const V=this.map.getView().getResolution();e.on("singleclick",function(h){const S=h.coordinate,N=ye(he(S));o.innerHTML="<p>Coordinate: </p><code>"+N+"</code>",f.setPosition(S);const k=e.getEventPixel(h.originalEvent);let T=[];this.noGetinfo=0,e.forEachLayerAtPixel(k,function(b,ya){if(b.title!="basemap"){var H=b.values_.source.getFeatureInfoUrl(h.coordinate,V,"EPSG:3857",{INFO_FORMAT:"application/json"});if(H){const te=new Request(H,t);fetch(te).then(I=>I.json()).then(I=>{c.innerHTML="<p>Value: </p><code>"+I.features[0].properties.GRAY_INDEX.toFixed(2)+" "+b.units+"</code>",i.innerHTML="<p>"+b.name.split("_").splice(0,2).join("_")+":"+b.date+"</p>"});let se=b.name.split("_").splice(0,2).join("_");b.name.split("_")[2],n[b.title][se].layer.forEach(I=>{var ae=I.values_.source.getFeatureInfoUrl(h.coordinate,V,"EPSG:3857",{INFO_FORMAT:"application/json"});let ie=fetch(ae).then(G=>G.json()).then(G=>{let F=G.features[0];if(F!=null){let J=F.properties.GRAY_INDEX;if(J!=null)return{Date:I.date,Value:J.toFixed(2)}}});T.push(ie)}),ke(T)}}else c.innerHTML="<p>Value: </p><code>N/A</code>",i.innerHTML="Click on a layer"})}),e.on("pointermove",function(h){if(h.dragging)return;const S=e.getEventPixel(h.originalEvent),N=e.forEachLayerAtPixel(S,function(k,T){if(k.title!="basemap")return!0});e.getTargetElement().style.cursor=N?"pointer":""})}).catch(a=>console.log("No layers have been found in the site url"))}},ca=r("div",{id:"map",class:"map"},null,-1);function da(t,a,s,n,e,l){const i=v("layerPanel"),o=v("metadataPanel"),c=v("timePanel"),d=v("basemapPanel"),f=v("slidePanel"),Y=v("plotPanel"),V=v("popUp");return p(),m("div",null,[ca,w(i,{child_msg:"Layer-Panel",layer_list:e.layer_list,onSetLayerVisible:l.setLayerVisible,onSetLayerOpacity:l.setLayerOpacity,onSetLayerMetadata:l.setLayerMetadata},null,8,["layer_list","onSetLayerVisible","onSetLayerOpacity","onSetLayerMetadata"]),w(o,{child_msg:"Metadata-Panel",settings:s.settings,title:e.title,abstract:e.abstract,to:e.to,tf:e.tf,typology:e.typology,units:e.units,crs:e.crs,legend:e.legend},null,8,["settings","title","abstract","to","tf","typology","units","crs","legend"]),w(c,{child_msg:"Time-Panel",title:e.title,datesList:e.datesList,datesListLength:e.datesListLength,currentDate:e.currentDate,currentDateIndex:e.currentDateIndex,currentGroup:e.currentGroup,onUpdateLayerSlider:l.setLayerVisibleTS,onUpdateLayerDropdown:l.setLayerVisibleTS,onStepBackwards:l.setLayerVisibleTS,onStepForwards:l.setLayerVisibleTS},null,8,["title","datesList","datesListLength","currentDate","currentDateIndex","currentGroup","onUpdateLayerSlider","onUpdateLayerDropdown","onStepBackwards","onStepForwards"]),w(d,{child_msg:"Basemap-Panel",data:e.basemap_settings,layer_list:e.layer_list,onSetLayerVisible:l.setLayerVisible},null,8,["data","layer_list","onSetLayerVisible"]),w(f,{child_msg:"Slide-Panel",settings:s.settings},null,8,["settings"]),w(Y,{child_msg:"Plot-Panel"}),w(V)])}var ua=y(oa,[["render",da]]);const pa={urlWMS:"https://ahocevar.com/geoserver/wms",urlWMSget:"http://localhost:3000/api/layers",typology:{CHL:{title:"Chlorophyll-a",abstract:"Chlorophyll-a allows plants to photosintezise. This measurement is used to classify the trophic conditionof a water body. The Chlorophyll-a maps presented have been processed using the Sentinel-3 OLCI sensor",style:"chl",units:"mg/m3"},TSM:{title:"Total Suspended Matter",abstract:"Total suspended matter concentration",style:"tsm",units:"g/m3"},LSWT:{title:"Lake Surface Water Temperature",abstract:"Average lake surface temperature",style:"lswt",units:"\xB0C"}},basemaps:[{layer:"osm",source:"osm",src:"osm.png",active:!0},{layer:"terrain",source:"terrain-labels",src:"terrain.png",active:!1},{layer:"toner",source:"toner",src:"toner.png",active:!1},{layer:"none",source:"none",src:"none.png",active:!1}],slides:[{title:"Welcome!",src:"i1.png",description:"1. SIMILE WebGIS enables the visualization of the water quality parameters (WQPs) maps produced for Lakes Maggiore, Lugano and Como."},{title:"Explore the different tools",src:"i2.png",description:"2. The WebGIS presents multtiple panels allowing to explore the different water quality parameters maps"},{title:"Visualize and explore the WQP",src:"i3.png",description:"3. Review the different components allowing the visualization of the maps, such as the layer panel, metadata panel and time controller"},{title:"Observe the evolution of the time series",src:"i4.png",description:"4. Use the time manager to observe the changes of the parameters in time."},{title:"Observe the evolution of the time series",src:"i5.png",description:"4. Use the time manager to observe the changes of the parameters in time."},{title:"Change the basemap",src:"i6.png",description:"5. Customize the view of the WebGIS by using different basemaps"},{title:"Explore the guide",src:"i7.png",description:"6. Review the guide for the WebGIS"}]};const ma={name:"App",data(){return{settings:pa}},components:{WebGISContainer:ua}};function _a(t,a,s,n,e,l){const i=v("WebGISContainer");return p(),j(i,{settings:e.settings},null,8,["settings"])}var ga=y(ma,[["render",_a],["__scopeId","data-v-5b99cd36"]]);ve(ga).mount("#app");
//# sourceMappingURL=index.94b8df21.js.map
