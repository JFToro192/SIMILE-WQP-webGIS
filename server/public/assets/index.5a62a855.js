import{C as T,O as Ne,a as ze,T as ie,M as Je,d as Xe,S as Ke,V as Re,W as Te,b as Ve,L as Ae,c as Ue,o as p,e as v,f as l,g as S,t as m,F as Z,r as ee,p as J,h as X,n as ne,i as Ge,j as Le,w as xe,k as Ze,v as et,l as tt,m as D,q as V,s as st,u as at,x as it,y as nt,z as rt,A as lt}from"./vendor.a6cca4b1.js";const ot=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}};ot();var ct="/assets/assev_simile.d3f83cf6.png";function dt(){const t="."+this.element.classList[0],e="."+t.split("-")[1]+"-item",s=$(t);s.hasClass("active")?($(`${e}`).slice(0).hide(),s.removeClass("active")):($(`${e}`).slice(0).show(),s.addClass("active"))}function te(){const t="."+this.element.classList[0],e="."+t.split("-")[1]+"-panel",s=$(t),i=$(e);i.hasClass("active")?(i.hide(),s.removeClass("active"),i.removeClass("active")):(i.show(),s.addClass("active"),i.addClass("active"))}function ut(t){var e=0,s=0,i=0,a=0;document.getElementById(t.id+"header")?document.getElementById(t.id+"header").onmousedown=r:t.onmousedown=r;function r(d){d=d||window.event,d.preventDefault(),i=d.clientX,a=d.clientY,document.onmouseup=c,document.onmousemove=n}function n(d){d=d||window.event,d.preventDefault(),e=i-d.clientX,s=a-d.clientY,i=d.clientX,a=d.clientY,t.style.top=t.offsetTop-s+"px",t.style.left=t.offsetLeft-e+"px"}function c(){document.onmouseup=null,document.onmousemove=null}}class pt extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-list"></i>';const a=document.createElement("div");a.className="show-burger ol-unselectable ol-control control-bar active",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",dt.bind(this),!1)}}class mt extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-map"></i>',i.title="layers panel";const a=document.createElement("div");a.className="show-layer ol-unselectable ol-control control-bar burger-item active",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class ht extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-info-square"></i>',i.title="metadata panel";const a=document.createElement("div");a.className="show-metadata ol-unselectable ol-control control-bar burger-item",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class yt extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-clock-history"></i>',i.title="time panel";const a=document.createElement("div");a.className="show-time ol-unselectable ol-control control-bar burger-item",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class gt extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-stack"></i>',i.title="basemaps";const a=document.createElement("div");a.className="show-basemap ol-unselectable ol-control control-bar burger-item",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class _t extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-graph-up"></i>',i.title="plot time series";const a=document.createElement("div");a.className="show-plot ol-unselectable ol-control control-bar burger-item",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class vt extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<i class="bi bi-file-earmark-easel"></i>',i.title="webgis guide";const a=document.createElement("div");a.className="show-slide ol-unselectable ol-control control-bar burger-item",a.appendChild(i);super({element:a,target:s.target});a.addEventListener("click",te.bind(this),!1)}}class ft extends T{constructor(e){const s=e||{},i=document.createElement("button");i.innerHTML='<a href="https://www.geonode.eo.simile.polimi.it/"><i class="bi bi-people-fill"></i> <p>GeoNode SIMILE</p></a>',i.src=i.title="GeoNode";const a=document.createElement("div");a.className="show-geonode ol-unselectable ol-control control-bar",a.appendChild(i);super({element:a,target:s.target})}}class bt extends T{constructor(e){const s=e||{},i=document.createElement("div"),a=document.createElement("a");a.href="https://www.progetti.interreg-italiasvizzera.eu/it/b/78/sistemainformativoperilmonitoraggiointegratodeilaghiinsubriciedeiloroe";const r=document.createElement("img");r.src=ct,r.alt="logo-simile-interreg",a.appendChild(r),i.appendChild(a);const n=document.createElement("div");n.className="project-logo ol-unselectable ol-control",n.appendChild(i);super({element:n,target:s.target})}}const At=new Ne,Lt=new ze({layers:[new ie({source:At})]});function xt(){return new Je({target:"map",controls:Xe().extend([new Ke,Lt,new pt,new mt,new ht,new yt,new gt,new _t,new vt,new bt,new ft]),view:new Re({center:[994904.36016,5775887605341e-6],zoom:10})})}const We={urlWMS:"https://www.geonode.eo.simile.polimi.it/geoserver/geonode/wms",urlWMSget:"https://www.webgis.eo.simile.polimi.it/api/getLayers",urlWMSfeatureInfo:"https://www.webgis.eo.simile.polimi.it/api/getLayerInfo",typology:{CHL:{title:"Chlorophyll-a",abstract:"Chlorophyll-a allows plants to photosintezise. This measurement is used to classify the trophic condition of a water body. The Chlorophyll-a maps presented have been processed using the Sentinel-3 OLCI sensor",style:"chl",units:"mg/m3"},TSM:{title:"Total Suspended Matter",abstract:"Total suspended matter concentration",style:"tsm",units:"g/m3"},LSWT:{title:"Lake Surface Water Temperature",abstract:"Average lake surface temperature",style:"lswt",units:"\xB0C"}},basemaps:[{layer:"osm",source:"osm",src:"osm.png",active:!0},{layer:"terrain",source:"terrain-labels",src:"terrain.png",active:!1},{layer:"toner",source:"toner",src:"toner.png",active:!1},{layer:"none",source:"none",src:"none.png",active:!1}],slides:[{title:"Welcome!",src:"i1.png",description:"1. SIMILE WebGIS enables the visualization of the water quality parameters (WQPs) maps produced for Lakes Maggiore, Lugano and Como.",details:"Explore the different panels available inside the toolbar menu"},{title:"Explore the different tools",src:"i2.png",description:"2. The WebGIS presents multiple panels allowing to explore the different water quality parameters maps",details:"(1) Layers Panel: The layers collections divide depending on the layers typologies; Each collection listed provide multiple options to control the layer (2) layer's visibility, (3) download the data, (4) access its metadata, and (5) control the layer opacity; The time series (collections) correspond to a group of layers from which it is possible to query datasets in time "},{title:"Visualize and explore the WQP",src:"i3.png",description:"3. Review the different components allowing the visualization of the maps, such as the layer panel, metadata panel and time controller",details:"In case of the time series, once set visible, this will activate the (1) Metadata and (2) Time Panels. In the (1) Metadata Panel you will find more information regarding the production of the maps. On the other hand, the (2) Time Panel will allow you to visualize the evolution of the active water quality parameter in time. Notice the timestamps are retrieved for the latest activated time series. The layers activation order will determine the layers overlay (the latest activated layer will be set on top)."},{title:"Observe the evolution of the time series",src:"i4.png",description:"4. Use the time manager to observe the changes of the parameters in time.",details:"Explore the available Water Quality Parameters Maps in time by searching for an specific date using the (1) dropdown list, or navigate through the dates using the (2) slider and (3) backwards/forwards controllers"},{title:"Observe the evolution of the time series",src:"i5.png",description:"5. Example time manager use for observing the changes of the parameters in time.",details:""},{title:"Change the basemap",src:"i6.png",description:"6. Customize the view of the WebGIS by using different basemaps",details:"Use the (1) Basemaps Panel to change the background map"},{title:"Query values from the layers",src:"i7.png",description:"7. Extract point values from the currently active layer",details:"Once a time series is active, it is possible to query the estimates of the Water Quality Parameters maps by clicking on layers. Here, you will find information about the WQP layer name, estimate value and location."},{title:"Review the evolution of the WQP at a point",src:"i8.png",description:"8. Plot time series of the estimates for a WQP at a point",details:"By clicking on a map, you will also be able to explore the evolution of the estimates by activating the (1) Plot Panel. The Plot Panel presents a dynamic graph were you can review the complete time series at a point, or clip the estimates according to the (2) range that can be edited in the subplot. Alternatively, you can clip the data by limiting the plot to a (3) month, or year (depending on the lenght of the time series, or return to the complete plot for the time series by clicking on (4) data. Note: the plot is presented for the latest activated layer (either from the Layer or Time Panels)"}]};function wt(t,e){document.getElementById("metric-modal").innerHTML="";var s=600,i=400,a=We.typology[e],r=[];t.forEach(function(o){o!=null&&r.push(o)}),r.forEach(function(o){o.month=d3.time.format("%Y-%m-%d").parse(o.month)}),r.sort(function(o,h){return d3.ascending(o.month,h.month)});var n={top:20,right:30,bottom:100,left:20},c=s-n.left-n.right+100,d=i-n.top-n.bottom,u={top:320,right:30,bottom:20,left:20},x=i-u.top-u.bottom,w=d3.extent(r,function(o){return o.month}),F=[0,d3.max(r,function(o){return o.count})],f=w[0],L=w[1],P=d3.time.format("%b %Y"),K=$e([[d3.time.format("%Y"),function(){return!0}],[d3.time.format("%m-%y"),function(o){return o.getMonth()}],[function(){return""},function(o){return o.getDate()!=1}]]),C=d3.time.scale().range([0,c]).domain(w),A=d3.scale.linear().range([d,0]).domain(F),le=d3.svg.axis().scale(C).orient("bottom").tickSize(-d).ticks(De).tickFormat(K),G=d3.svg.axis().scale(A).ticks(4).tickSize(-c).orient("right"),Y=d3.time.scale().range([0,c]).domain([f,L]),se=d3.scale.linear().range([x,0]).domain(A.domain()),me=d3.svg.axis().scale(Y).orient("bottom").ticks(De).tickFormat(K),B=d3.svg.line().x(function(o){return C(o.month)}).y(function(o){return A(o.count)}),oe=d3.svg.area().x(function(o){return C(o.month)}).y0(d).y1(function(o){return A(o.count)}),ce=d3.svg.area().x(function(o){return Y(o.month)}).y0(x).y1(function(o){return se(o.count)}),R=d3.svg.line().x(function(o){return Y(o.month)}).y(function(o){return se(o.count)}),b=d3.svg.brush().x(Y).on("brush",Pe).on("brushend",Be),H=d3.behavior.zoom().on("zoom",ge).on("zoomend",Be),M=d3.select("#metric-modal").append("svg").attr("width",c+n.left+n.right).attr("height",d+n.top+n.bottom).attr("class","metric-chart");M.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",c).attr("height",d);var W=M.append("g").attr("class","context").attr("transform","translate("+u.left+","+u.top+")"),I=M.append("g").attr("class","focus").attr("transform","translate("+n.left+","+n.top+")");M.append("svg:rect").attr("class","pane").attr("width",c).attr("height",d).attr("transform","translate("+n.left+","+n.top+")").call(H).call(ge);var de=M.append("g").attr("id","buttons_group").attr("transform","translate("+0+","+0+")");de.append("text").text("Time series between: ").style("text-anchor","start").attr("transform","translate("+0+","+10+")"),de.append("text").attr("id","displayDates").text(P(w[0])+" - "+P(w[1])).style("text-anchor","start").attr("transform","translate("+135+","+10+")"),de.append("text").text("Zoom to: ").style("text-anchor","start").attr("transform","translate("+270+","+10+")");var he=40,Ie=14,Fe=w[1]-w[0],Ye=3154e7;if(Fe<Ye)var Se=["month","data"];else var Se=["year","month","data"];var Ee=de.selectAll("g").data(Se).enter().append("g").attr("class","scale_button").attr("transform",function(o,h){return"translate("+(330+h*he+h*10)+",0)"}).on("click",qe);Ee.append("rect").attr("width",he).attr("height",Ie).attr("rx",1).attr("ry",1),Ee.append("text").attr("dy",Ie/2+3).attr("dx",he/2).style("text-anchor","middle").text(function(o){return o}),I.append("g").attr("class","y axis").call(G).attr("transform","translate("+c+", 0)"),I.append("path").datum(r).attr("class","area").attr("d",oe),I.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(le),I.append("path").datum(r).attr("class","line").attr("d",B),W.append("path").datum(r).attr("class","area").attr("d",ce),W.append("path").datum(r).attr("class","line").attr("d",R),W.append("g").attr("class","x axis").attr("transform","translate(0,"+x+")").call(me);var ye=W.append("g").attr("class","x brush").call(b);ye.selectAll(".extent").attr("y",-6).attr("height",x+8),ye.selectAll(".resize").append("rect").attr("class","handle").attr("transform","translate(0,"+-3+")").attr("rx",2).attr("ry",2).attr("height",x+6).attr("width",3),ye.selectAll(".resize").append("rect").attr("class","handle-mini").attr("transform","translate(-2,8)").attr("rx",3).attr("ry",3).attr("height",x/2).attr("width",7),M.append("text").attr("class","y axis title").text(`${e} [${a.units}]`).attr("x",-(d/2)).attr("y",0).attr("dy","1em").attr("transform","rotate(-90)").style("text-anchor","middle"),H.x(C);function $e(o){return function(h){for(var y=o.length-1,g=o[y];!g[1](h);)g=o[--y];return g[0](h)}}function De(o,h,y){var g=24,k=Math.floor(c/g);function N(z,fe){z.setMonth(z.getMonth()+fe)}for(var q=d3.time.month.ceil(o),O=[],j=[1,3,4,12];q<h;)O.push(new Date(+q)),N(q,1);var ue=O,ae;for(ae=0;O.length>k;ae++)O=_.filter(ue,function(z){return z.getMonth()%j[ae]==0});return O}function Pe(){C.domain(b.empty()?Y.domain():b.extent()),I.select(".area").attr("d",oe),I.select(".line").attr("d",B),I.select(".x.axis").call(le),H.x(C),Me(),ke()}function ge(){ke(),I.select(".area").attr("d",oe),I.select(".line").attr("d",B),I.select(".x.axis").call(le),b.extent(C.domain()),M.select(".brush").call(b),Me()}function Be(){var o=b.extent(),h=b.extent().some(function(y){return y<f|y>L});h&&(o=He(o))}function Me(){var o=b.extent(),h=b.empty()?P(w[0]):P(o[0]),y=b.empty()?P(w[1]):P(o[1]);d3.select("#displayDates").text(h==y?h:h+" - "+y)}function He(o){var h=31536e6,y,g;return o[0]<f?y=f:o[0]>L?y=new Date(L.getTime()-h):y=o[0],o[1]>L?g=L:o[1]<f?g=new Date(f.getTime()+h):g=o[1],b.extent([y,g]),b(d3.select(".brush").transition()),Pe(),ge(),b.extent()}function ke(){var o=new Date(C.domain()[0]),h=new Date(C.domain()[1]),y=d3.bisector(function(U){return U.month}).right,g=y(r,o);if(r[g]!==void 0&&r[g-1]!==void 0)var k=r[g-1].month,N=r[g].month,q=d3.interpolateNumber(r[g-1].count,r[g].count),O=q((o-k)/(N-k));else var O=0;var j=y(r,h);if(r[j]!==void 0&&r[j-1]!==void 0)var ue=r[j-1].month,ae=r[j].month,q=d3.interpolateNumber(r[j-1].count,r[j].count),z=q((h-ue)/(ae-ue));else var z=0;var fe=r.filter(function(U){return U.month>=o&&U.month<=h}),pe=[];fe.map(function(U){pe.push(U.count)}),pe.push(O),pe.push(z);var be=d3.max(pe);be==0&&(be=F[1]),A.domain([0,be*1.05]),I.select(".y.axis").call(G)}function qe(o,h){var y=b.extent(),g,k,N;o=="year"?g=31536e6:o=="month"&&(g=2592e6),o=="year"|o=="month"?L.getTime()-y[1].getTime()<g?(N=new Date(L.getTime()-g),k=L):(N=y[0],k=new Date(y[0].getTime()+g)):o=="data"?(N=w[0],k=w[1]):(N=y[0],k=y[1]),b.extent([N,k]),b(d3.select(".brush").transition()),b.event(d3.select(".brush").transition())}var _e=document.querySelectorAll("path.area");e=="LSWT"?_e.forEach(o=>{o.setAttribute("style","fill:#96DEFF")}):e=="CHL"?_e.forEach(o=>{o.setAttribute("style","fill:#96FFC2")}):e=="TSM"&&_e.forEach(o=>{o.setAttribute("style","fill:#FFD696")});var ve=document.querySelectorAll("path.line");e=="LSWT"?ve.forEach(o=>{o.setAttribute("style","stroke:#0082A8")}):e=="CHL"?ve.forEach(o=>{o.setAttribute("style","stroke:#00A835")}):e=="TSM"&&ve.forEach(o=>{o.setAttribute("style","stroke:#FF9B00")})}new Te;function we(t,e,s,i){return new ie({source:new Ue({url:e,params:{LAYERS:t,TILED:!0,STYLES:i},serverType:"geoserver"}),visible:!1,opacity:s})}function Oe(t,e){return t[e.name]={},t[e.name].workspace=e.workspace,t[e.name].typology=e.typology,t[e.name].crs=e.crs,t[e.name].sensor=e.sensor,t[e.name].timeComplete=[e.timeComplete],t[e.name].timeFormatted=[e.timeFormatted],t[e.name].level=e.level,t[e.name].layer=[e.layer],t}function Ct(t,e,s){let i=Object.keys(e),a={};return a.static={},a.time={},a.basemap={},t.forEach(r=>{let n={},c=r.Name.split(":");if(c[1].split("_")[2]=="IT"){if(n.workspace=c[0],n.name=c[1].split("_").slice(0,3).join("_"),n.sensor=c[1].split("_")[0],n.typology=c[1].split("_")[1],n.crs=c[1].split("_")[2],c[1].split("_")[3]!=null){n.timeComplete=c[1].split("_")[3];let u=c[1].split("_")[3].split("T")[0];n.timeFormatted=u.slice(0,4)+"-"+u.slice(4,6)+"-"+u.slice(6,8)}else n.timeComplete=void 0,n.timeFormatted=void 0;n.level=c[1].split("_")[4];let d="";i.includes(n.typology)&&(d=n.typology.toLowerCase()),n.layer=we(r.Name,s,.5,d),n.timeComplete!=null?n.name in a.time?(n.layer=we(r.Name,s,1,d),n.layer.title="time",n.layer.date=n.timeFormatted,n.layer.name=n.name,n.name.split("_")[1]=="LSWT"?n.layer.units="[\xB0C]":n.name.split("_")[1]=="CHL"?n.layer.units="[mg/m3]":n.name.split("_")[1]=="TSM"&&(n.layer.units="[g/m3]"),a.time[n.name].timeComplete.push(n.timeComplete),a.time[n.name].timeFormatted.push(n.timeFormatted),a.time[n.name].layer.push(n.layer)):(n.layer=we(r.Name,s,1),n.layer.title="time",n.layer.name=n.name,n.layer.date=n.timeFormatted,n.name.split("_")[1]=="LSWT"?n.layer.units="[\xB0C]":n.name.split("_")[1]=="CHL"?n.layer.units="[mg/m3]":n.name.split("_")[1]=="TSM"&&(n.layer.units="[g/m3]"),a.time=Oe(a.time,n)):a.static=Oe(a.static,n)}}),a}function It(t){let e={osm:{title:"osm",layer:[new ie({source:new Ne,visible:!0})]},terrain:{title:"terrain",source:"Stamen",layer:[new ie({source:new Ve({layer:"terrain"}),visible:!1})]},toner:{title:"toner",source:"Stamen",layer:[new ie({source:new Ve({layer:"toner"}),visible:!1})]}};return t.basemap=e,t}function je(t){let e={},s=[],i=[],a=[],r=[],n=[];for(let c in t)if(c=="time"){let d=0;for(let u in t[c]){let x=t[c][u].layer;n.push(new Ae({layers:x,visible:!0,opacity:.8})),n[d].name=u.replace("_IT",""),d++}}else{for(let d in t[c])if(c=="basemap"){let u=t[c][d].layer[0];u.title="basemap",s.push(u)}else if(c=="static"){let u=t[c][d].layer[0];u.title="static",i.push(u)}r[0]=new Ae({layers:i,visible:!0,opacity:1}),a[0]=new Ae({layers:s,visible:!0,opacity:1})}return e.basemap=a,e.static=r,e.time=n,e}function St(t){var e=document.querySelector(".metric-chart");try{e.remove()}catch(s){}Promise.all(t.values).then(s=>{wt(s,t.typology)})}var E=(t,e)=>{const s=t.__vccOpts||t;for(const[i,a]of e)s[i]=a;return s};const Et={name:"Layer",props:{child_msg:{type:String,default:"Layer Panel"},layer_list:{type:Object}},data(){return{}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"},setLayerVisible(t,e,s,i,a){this.$emit("setLayerVisible",{nGroup:e,index:s}),t.target.checked&&this.setLayerMetadata(i,a)},setLayerOpacity(t,e,s){let i=t.target.value;this.$emit("setLayerOpacity",{opacity:i,nGroup:e,index:s})},setLayerMetadata(t,e){this.$emit("setLayerMetadata",{layerType:t,layerName:e})}}},re=t=>(J("data-v-14ba28cd"),t=t(),X(),t),Dt={id:"layerPanel",class:"layer-panel ol-unselectable ol-control active"},Pt={class:"panel-title"},Bt={class:"static-layers active",id:"staticLayers"},Mt={class:"layer-items"},kt=["onChange"],Nt={class:"title-layer"},Tt=["title"],Vt=["onClick"],Gt=re(()=>l("i",{class:"bi bi-info-square"},null,-1)),Wt=[Gt],Ot=re(()=>l("div",{class:"opct-layer"},[l("i",{class:"bi bi-brightness-high"})],-1)),jt={class:"opct-range-layer"},Qt=["onChange"],Ft=re(()=>l("h6",{class:"time-series-layers-title"},[l("i",{class:"bi bi-arrow-right"}),S("Time Series")],-1)),Yt={class:"time-series-layers active",id:"timeSeriesLayers"},$t={class:"layer-items"},Ht=["onChange"],qt={class:"title-layer"},zt=["title"],Jt=["onClick"],Xt=re(()=>l("i",{class:"bi bi-info-square"},null,-1)),Kt=[Xt],Rt=re(()=>l("div",{class:"opct-layer"},[l("i",{class:"bi bi-brightness-high"})],-1)),Ut={class:"opct-range-layer"},Zt=["onChange"];function es(t,e,s,i,a,r){return p(),v("div",Dt,[l("div",Pt,[S(m(s.child_msg)+" ",1),l("button",{class:"close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=n=>r.closePanel(n))},"x")]),l("div",Bt,[(p(!0),v(Z,null,ee(s.layer_list.static,(n,c,d)=>(p(),v("div",{class:"static-layer layer-list",key:n.static},[l("div",Mt,[l("div",{class:ne("chckbx-layer layer-static-"+d)},[l("input",{type:"checkbox",title:"set visible",name:"",id:"",class:ne("layer-static-"+d),onChange:u=>r.setLayerVisible(u,1,d,"static",{key:c})},null,42,kt)],2),l("div",Nt,[l("p",{title:c},m(c),9,Tt)]),l("div",{class:"info-layer",onClick:u=>r.setLayerMetadata("static",{key:c})},Wt,8,Vt),Ot,l("div",jt,[l("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.8",onChange:u=>r.setLayerOpacity(u,1,d)},null,40,Qt)])])]))),128))]),Ft,l("div",Yt,[(p(!0),v(Z,null,ee(s.layer_list.time,(n,c,d)=>(p(),v("div",{class:"time-series-layer layer-list",key:n.time},[l("div",$t,[l("div",{class:ne("chckbx-layer"+d)},[l("input",{type:"checkbox",title:"set visible",name:"",id:"",class:ne("layer-timeSeries-"+d),onChange:u=>r.setLayerVisible(u,2,d,"time",{key:c})},null,42,Ht)],2),l("div",qt,[l("p",{title:c},m(c),9,zt)]),l("div",{class:"info-layer",onClick:u=>r.setLayerMetadata("time",{key:c})},Kt,8,Jt),Rt,l("div",Ut,[l("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.8",onChange:u=>r.setLayerOpacity(u,2,d)},null,40,Zt)])])]))),128))])])}var ts=E(Et,[["render",es],["__scopeId","data-v-14ba28cd"]]);const ss={name:"Layer",props:{child_msg:{type:String,required:!0,default:"Metadata Panel"},title:{type:String,required:!0,default:"Title"},abstract:{type:String,required:!0,default:"Select a layer"},typology:{type:String,required:!0,default:"N/A"},units:{type:String,required:!0,default:"N/A"},crs:{type:String,required:!0,default:"N/A"},to:{type:String,required:!0,default:"N/A"},tf:{type:String,required:!0,default:"N/A"},legend:{type:String,required:!0,default:"N/A"}},data(){return{}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"}}},Q=t=>(J("data-v-1d49f2c6"),t=t(),X(),t),as={id:"metadataPanel",class:"metadata-panel ol-unselectable ol-control"},is={class:"panel-title"},ns={class:"meta-title"},rs={class:"meta-abstract"},ls={class:"meta-info"},os={class:"meta-details"},cs={class:"meta-details-typology"},ds=Q(()=>l("strong",null,"Typology:",-1)),us={class:"meta-details-units"},ps=Q(()=>l("strong",null,"Units:",-1)),ms={class:"meta-details-crs"},hs=Q(()=>l("strong",null,"CRS:",-1)),ys={class:"meta-details-tstart"},gs=Q(()=>l("strong",null,"Time Start:",-1)),_s=Q(()=>l("br",null,null,-1)),vs={class:"meta-details-tend"},fs=Q(()=>l("strong",null,"Time end:",-1)),bs=Q(()=>l("br",null,null,-1)),As={class:"meta-legend"},Ls=Q(()=>l("div",null,[l("strong",null,"Legend:")],-1)),xs={class:"meta-legend-image"},ws=["src"];function Cs(t,e,s,i,a,r){return p(),v("div",as,[l("div",is,[S(m(s.child_msg)+" ",1),l("button",{class:"close-basemap close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=n=>r.closePanel(n))},"x")]),l("div",ns,[l("h6",null,m(s.title),1)]),l("div",rs,m(s.abstract),1),l("div",ls,[l("div",os,[l("div",cs,[ds,S(m(s.typology),1)]),l("div",us,[ps,S(" ["+m(s.units)+"]",1)]),l("div",ms,[hs,S(m(s.crs),1)]),l("div",ys,[gs,_s,S(m(s.to),1)]),l("div",vs,[fs,bs,S(m(s.tf),1)])]),l("div",As,[Ls,l("div",xs,[l("img",{src:s.legend,alt:""},null,8,ws)])])])])}var Is=E(ss,[["render",Cs],["__scopeId","data-v-1d49f2c6"]]);const Ss={name:"Time",props:{child_msg:{type:String,default:"Time Panel"},title:{type:String,required:!0,default:"Select Layer"},datesList:{type:Object,required:!0,default:()=>({"0":"Select TS"})},datesListLength:{type:Number,required:!0},currentDate:{type:String,required:!0},currentDateIndex:{type:Number,required:!0},currentGroup:{type:Number,required:!0},currentGroupIndex:{type:Number,required:!0},isLayerActive:{type:Boolean,required:!0},activeLayersList:{type:Object,required:!0}},data(){return{}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"},updateLayerSlider(t){if(this.isLayerActive){let e=t.target.value,s=parseInt(e),i=this.currentGroup+2,a=document.getElementById("dropdownDate");a.selectedIndex=e,this.cDate=this.datesList[e],this.cDateIndex=e,this.$emit("updateLayerSlider",{nGroup:i,emitDate:s})}},updateGroupDropdown(t){let e=parseInt(t.srcElement.value)+2,s=this.activeLayersList[t.srcElement.value].name,i=this.activeLayersList[t.srcElement.value].datesList,a=i[i.length-1];this.$emit("updateGroupDropdown",{name:s,nGroup:e,emitDate:a})},updateLayerDropdown(t){if(this.isLayerActive){let e=t.target.value,s=parseInt(e),i=this.currentGroup+2,a=document.getElementById("sliderDate");a.value=e,this.cDate=this.datesList[e],this.cDateIndex=e,this.$emit("updateLayerDropdown",{nGroup:i,emitDate:s})}},stepBackwards(){let t=document.getElementById("sliderDate").value,e=t-1,s=t-1,i=this.currentGroup+2;this.isLayerActive==!0&&(t-1>=0?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:i,emitDate:e})):alert("There are no previous maps for the current layer"))},stepForwards(){let t=document.getElementById("dropdownDate").value,e=Number(t)+1,s=Number(t)+1,i=this.currentGroup+2;this.isLayerActive==!0&&(Number(t)+1<=this.datesListLength-1?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:i,emitDate:e})):alert("There are no later maps for the current layer"))}}},Ce=t=>(J("data-v-cf6cd188"),t=t(),X(),t),Es={id:"timePanel",class:"time-panel ol-unselectable ol-control"},Ds={class:"panel-title"},Ps={class:"time-container"},Bs={class:"time-header"},Ms=Ce(()=>l("strong",null,"Select a ts:",-1)),ks=["value"],Ns=["value"],Ts={class:"time-controls"},Vs={class:"time-controls-dates"},Gs=["value","selected"],Ws={class:"time-slider"},Os=["max","value"],js={id:"time-controls-backward",class:"time-controls_item ol-unselectable ol-control"},Qs=Ce(()=>l("i",{class:"bi bi-skip-backward-circle"},null,-1)),Fs=[Qs],Ys={id:"time-controls-forward",class:"time-control s_item ol-unselectable ol-control"},$s=Ce(()=>l("i",{class:"bi bi-skip-forward-circle"},null,-1)),Hs=[$s];function qs(t,e,s,i,a,r){return p(),v("div",Es,[l("div",Ds,[S(m(s.child_msg)+" ",1),l("button",{class:"close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=n=>r.closePanel(n))},"x")]),l("div",Ps,[l("div",Bs,[Ms,l("select",{class:"time-select-group",name:"",id:"dropDownGroup",value:s.currentGroupIndex,onChange:e[1]||(e[1]=n=>r.updateGroupDropdown(n))},[(p(!0),v(Z,null,ee(s.activeLayersList,(n,c)=>(p(),v("option",{value:c,key:c},m(n.name),9,Ns))),128))],40,ks)]),l("div",Ts,[l("div",Vs,[l("select",{name:"",id:"dropdownDate",onChange:e[2]||(e[2]=n=>r.updateLayerDropdown(n))},[(p(!0),v(Z,null,ee(s.datesList,(n,c)=>(p(),v("option",{value:c,selected:s.datesListLength,key:c},m(s.datesList[c]),9,Gs))),128))],32)]),l("div",Ws,[l("input",{type:"range",name:"",id:"sliderDate",min:"0",max:s.datesListLength-1,value:s.currentDateIndex,step:"1",onChange:e[3]||(e[3]=n=>r.updateLayerSlider(n))},null,40,Os)]),l("div",js,[l("button",{class:"time-panel-control-button",onClick:e[4]||(e[4]=(...n)=>r.stepBackwards&&r.stepBackwards(...n))},Fs)]),l("div",Ys,[l("button",{class:"time-panel-control-button",onClick:e[5]||(e[5]=(...n)=>r.stepForwards&&r.stepForwards(...n))},Hs)])])])])}var zs=E(Ss,[["render",qs],["__scopeId","data-v-cf6cd188"]]),Js="/assets/osm.d6d13acb.png",Xs="/assets/terrain.d843a7bb.png",Ks="/assets/watercolor.8d0c5f2f.png",Rs="/assets/toner.19bbfbf8.png",Us="data:image/png;base64,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";const Zs={name:"Basemap",props:{child_msg:{type:String,default:"Basemap Panel"},data:{type:Array},layer_list:{type:Object,require:!0}},data(){return{}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"},getImage(t){if(t=="osm")return Js;if(t=="terrain")return Xs;if(t=="watercolor")return Ks;if(t=="toner")return Rs;if(t=="none")return Us},setLayerVisible(t,e){this.$emit("setLayerVisible",{nGroup:t,index:e})}}},ea={id:"basemapPanel",class:"basemap-panel ol-unselectable ol-control"},ta={class:"panel-title"},sa={class:"basemap-container"},aa=["id","checked","onChange"],ia=["src"];function na(t,e,s,i,a,r){return p(),v("div",ea,[l("div",ta,[S(m(s.child_msg)+" ",1),l("button",{class:"close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=n=>r.closePanel(n))},"x")]),l("div",sa,[(p(!0),v(Z,null,ee(s.data,(n,c)=>(p(),v("div",{key:n.layer,class:"basemap-container_item"},[l("div",null,[l("input",{type:"radio",name:"basemap-radio",id:n.layer+"-option",class:ne("basemap-option"),checked:n.active,onChange:d=>r.setLayerVisible(0,c)},null,40,aa),l("p",null,m(n.layer),1)]),l("img",{src:r.getImage(n.layer),alt:""},null,8,ia)]))),128))])])}var ra=E(Zs,[["render",na],["__scopeId","data-v-1046730e"]]);const la={name:"Plot",props:{child_msg:{type:String,default:"Plot Panel"}},data(){return{}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"}}},oa=t=>(J("data-v-360a66f8"),t=t(),X(),t),ca={id:"plotPanel",class:"plot-panel ol-unselectable ol-control"},da={class:"panel-title"},ua=oa(()=>l("div",{id:"metric-modal"},null,-1));function pa(t,e,s,i,a,r){return p(),v("div",ca,[l("div",da,[S(m(s.child_msg)+" ",1),l("button",{class:"close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=n=>r.closePanel(n))},"x")]),ua])}var ma=E(la,[["render",pa],["__scopeId","data-v-360a66f8"]]),ha="/assets/i1.11f1dc39.png",ya="/assets/i2.de9aba41.png",ga="/assets/i3.23836b3d.png",_a="/assets/i4.aa86bd13.png",va="/assets/i5.10782724.png",fa="/assets/i6.8af0a6b5.png",ba="/assets/i7.1b6f31d5.png",Aa="/assets/i8.da32729e.png",La="/assets/i9.41fe8a9c.png";const xa={data(){return{}},methods:{prev(){this.$emit("prev")},next(){this.$emit("next")}}},Qe=t=>(J("data-v-0fd625ec"),t=t(),X(),t),wa={class:"carousel-container"},Ca=Qe(()=>l("i",{class:"bi bi-caret-left-fill"},null,-1)),Ia=[Ca],Sa=Qe(()=>l("i",{class:"bi bi-caret-right-fill"},null,-1)),Ea=[Sa];function Da(t,e,s,i,a,r){return p(),v("div",wa,[Ge(t.$slots,"default",{},void 0,!0),l("button",{class:"prev",onClick:e[0]||(e[0]=(...n)=>r.prev&&r.prev(...n))},Ia),l("button",{class:"next",onClick:e[1]||(e[1]=(...n)=>r.next&&r.next(...n))},Ea)])}var Pa=E(xa,[["render",Da],["__scopeId","data-v-0fd625ec"]]);const Ba={props:["visibleSlide","index","direction"],data(){return{}}},Ma={class:"carousel-slide"};function ka(t,e,s,i,a,r){return p(),Le(tt,{name:s.direction},{default:xe(()=>[Ze(l("div",Ma,[Ge(t.$slots,"default",{},void 0,!0)],512),[[et,s.visibleSlide===s.index]])]),_:3},8,["name"])}var Na=E(Ba,[["render",ka],["__scopeId","data-v-0280ffd5"]]);const Ta={name:"Slide",props:{child_msg:{type:String,default:"Slide Panel"},settings:{type:Object}},data(){return{visibleSlide:0,direction:""}},computed:{slidesLen(){return this.settings.slides.length}},methods:{closePanel(t){let e=t.path[2],s=".show-"+e.classList[0].split("-")[0];document.querySelector(s).classList.remove("active"),e.classList.remove("active"),e.style.display="none"},prev(){this.visibleSlide<=0?this.visibleSlide=this.slidesLen-1:this.visibleSlide--,this.direction="right"},next(){this.visibleSlide>=this.slidesLen-1?this.visibleSlide=0:this.visibleSlide++,this.direction="left"},getImage(t){if(t=="i1.png")return ha;if(t=="i2.png")return ya;if(t=="i3.png")return ga;if(t=="i4.png")return _a;if(t=="i5.png")return va;if(t=="i6.png")return fa;if(t=="i7.png")return ba;if(t=="i8.png")return Aa;if(t=="i9.png")return La}},mounted(){},components:{CarouselContainer:Pa,CarouselSlide:Na}},Va=t=>(J("data-v-a1d99ae4"),t=t(),X(),t),Ga={id:"slidePanel",class:"slide-panel ol-unselectable ol-control",style:{display:"none"}},Wa={class:"panel-title"},Oa={class:"slidepanel-show"},ja={class:"slide-title"},Qa={class:"slide-description"},Fa={class:"slide-illustration"},Ya={class:"slide-image"},$a=["src","alt"],Ha={class:"slide-details"},qa=Va(()=>l("div",{class:"slide-current"},null,-1));function za(t,e,s,i,a,r){const n=D("carousel-slide"),c=D("carousel-container");return p(),v("div",Ga,[l("div",Wa,[S(m(s.child_msg)+" ",1),l("button",{class:"close-panel-btn",style:{color:"red"},onClick:e[0]||(e[0]=d=>r.closePanel(d))},"x")]),l("div",Oa,[V(c,{onPrev:r.prev,onNext:r.next},{default:xe(()=>[(p(!0),v(Z,null,ee(s.settings.slides,(d,u)=>(p(),Le(n,{key:d,index:u,visibleSlide:a.visibleSlide,direction:a.direction},{default:xe(()=>[l("div",ja,m(d.title),1),l("div",Qa,m(d.description),1),l("div",Fa,[l("div",Ya,[l("img",{src:r.getImage(d.src),alt:u},null,8,$a)]),l("div",Ha,m(d.details),1)])]),_:2},1032,["index","visibleSlide","direction"]))),128))]),_:1},8,["onPrev","onNext"])]),qa])}var Ja=E(Ta,[["render",za],["__scopeId","data-v-a1d99ae4"]]);const Xa={setup(){},data:function(){return{}},props:{map:{type:Object,required:!0},title:{type:String,required:!0,default:"Select layer"},evtCoordinate:{type:String,required:!0,default:"N/A"},pixelCoordinate:{type:String,required:!0,default:"click-on map"},pixelInfo:{type:String,required:!0,default:"N/A"},pixelUnits:{type:String,required:!0,default:"N/A"}}},Ka=t=>(J("data-v-2414ef08"),t=t(),X(),t),Ra={id:"popup",class:"ol-popup"},Ua={id:"popup-title"},Za=Ka(()=>l("a",{href:"#",id:"popup-closer",class:"ol-popup-closer"},null,-1)),ei={id:"popup-info"},ti={id:"popup-getinfo"},si={id:"popup-coordinate"};function ai(t,e,s,i,a,r){return p(),v("div",Ra,[l("div",Ua,m(s.title),1),Za,l("div",ei,[l("div",ti,"Value: "+m(s.pixelInfo)+" "+m(s.pixelUnits),1),l("div",si,"Coordinates: "+m(s.pixelCoordinate),1)])])}var ii=E(Xa,[["render",ai],["__scopeId","data-v-2414ef08"]]);const ni={name:"Loading",props:{isLoading:{type:Boolean,required:!0}}},ri={key:0,class:"loading-container"},li=st('<div class="loading-background" data-v-48d18194><img src="https://www.infosostenibile.it/sites/default/files/styles/immagine_in_evidenza/public/immagini/news/progetto-simile-3.jpg?itok=mRBRenZx" alt="SIMILE" style="position:absolute;height:100%;width:100%;top:0;right:0;" data-v-48d18194></div><div class="loading-message" data-v-48d18194><div class="loading-message-contents" data-v-48d18194><h1 data-v-48d18194>Welcome to SIMILE&#39;s WebGIS</h1><p data-v-48d18194>Please wait for the layers to load</p><div class="snippet" data-title="dot-pulse" data-v-48d18194><div class="stage" data-v-48d18194><div class="dot-pulse" data-v-48d18194></div></div></div></div></div>',2),oi=[li],ci={key:1,style:{display:"none"}};function di(t,e,s,i,a,r){return s.isLoading?(p(),v("div",ri,oi)):(p(),v("div",ci))}var ui=E(ni,[["render",di],["__scopeId","data-v-48d18194"]]),pi="/assets/chl_legend.0a343d52.png",mi="/assets/tsm_legend.f2fd6003.png",hi="/assets/lswt_legend.fe179139.png";const yi=new Te,gi={name:"WebGISContainer",data(){return{basemap_settings:this.settings.basemaps,urlLayerInfo:this.settings.urlWMSLayerInfo,layer_list:{},layer_groups:{},map:{},title:"Select a Layer",typology:"N/A",abstract:"N/A",to:"N/A",tf:"N/A",crs:"N/A",units:"N/A",legend:"N/A",datesList:[],currentGroup:0,currentGroupIndex:0,currentDate:"",currentDateIndex:0,isLayerActive:!1,datesListLength:0,noGetinfo:0,activeLayersList:{},zIndexLayer:0,isLoading:!0}},props:{settings:{type:Object,required:!0}},components:{layerPanel:ts,metadataPanel:Is,timePanel:zs,basemapPanel:ra,plotPanel:ma,slidePanel:Ja,popUp:ii,loadingScreen:ui},methods:{updatedDropdown(t){t.emitDate;let e=t.name,s=t.nGroup,i=this.map.getLayers().array_[s];this.currentGroup=s-2,this.currentGroupIndex=this.currentGroup,this.datesList=this.layer_list.time[e].timeFormatted,this.zIndexLayer++,this.currentDate=this.datesList[Object.keys(this.datesList).length-1],this.currentDateIndex=Object.keys(this.datesList).length,this.datesListLength=Object.keys(this.datesList).length,t={layerType:"time",layerName:{key:e}},this.setLayerMetadata(t),i.setZIndex(this.zIndexLayer)},setLayerVisible(t){let e=t.index,s=t.nGroup;if(t.evtType,s==0){let i=this.map.getLayers().array_[s].values_.layers.array_;i.forEach((a,r)=>{e!=r||i.length<e?a.setVisible(!1):a.setVisible(!0)})}else if(s==1){let i=this.map.getLayers().array_[s].values_.layers.array_[e].getVisible();this.map.getLayers().array_[s].values_.layers.array_[e].setVisible(!i)}else{let i=this.map.getLayers().array_[s+e];if(e in this.activeLayersList){delete this.activeLayersList[e];let c=Object.keys(this.activeLayersList);c.length>0&&(this.currentGroupIndex=this.activeLayersList[c[0]].currentGroup,this.zIndexLayer+=1,this.activeLayersList[c[0]].zindex=this.zIndexLayer,this.map.getLayers().array_[s+parseInt(c[0])].setZIndex(this.activeLayersList[c[0]].zindex))}else this.zIndexLayer++,this.activeLayersList[e]={name:i.name,datesList:this.datesList,datesListLength:this.datesListLength,currentDate:this.currentDate,currentDateIndex:this.currentDateIndex,currentGroup:e,zindex:this.zIndexLayer},this.currentGroupIndex=e,i.setZIndex(this.activeLayersList[e].zindex);let a=i.values_.layers.array_.length-1,r=this.map.getLayers().array_[s+e].values_.layers.array_,n=0;r.forEach((c,d)=>{let u=this.map.getLayers().array_[s+e].values_.layers.array_[d].getVisible();c.getVisible()==!0&&d!=a&&s+e-2==this.currentGroup?(this.map.getLayers().array_[s+e].values_.layers.array_[d].setVisible(!u),n++,this.isLayerActive=c.getVisible()):c.getVisible()==!0&&d!=a?(this.map.getLayers().array_[s+e].values_.layers.array_[d].setVisible(!u),n++):n==0&&d==a?(this.map.getLayers().array_[s+e].values_.layers.array_[a].setVisible(!u),this.currentDate=c.date,c.getVisible()==!0&&d==a&&(this.isLayerActive=c.getVisible())):c.getVisible()==!1&&s+e-2==this.currentGroup&&(this.isLayerActive=!1)})}},setLayerVisibleTS(t){let e=t.nGroup,s=t.emitDate;this.map.getLayers().array_[e].values_.layers.array_.forEach((a,r)=>{s==r?a.setVisible(!0):a.setVisible(!1)})},setLayerOpacity(t){let e=t.opacity,s=t.index,i=t.nGroup;if(i<=1)this.map.getLayers().array_[i].values_.layers.array_[s].getVisible()==!0?(this.map.getLayers().array_[i].values_.layers.array_[s].setVisible(!1),this.map.getLayers().array_[i].values_.layers.array_[s].values_.opacity=e,this.map.getLayers().array_[i].values_.layers.array_[s].setVisible(!0)):this.map.getLayers().array_[i].values_.layers.array_[s].values_.opacity=e;else{let a=this.map.getLayers().array_[i+s];a.getVisible()==!0?(a.setVisible(!1),a.values_.opacity=e,a.setVisible(!0)):a.values_.opacity=e}},setLayerMetadata(t){let e=t.layerType,s=t.layerName.key,i=this.layer_list[e][s];if(this.title=s,e=="time"){let a=i.typology,r=i.timeFormatted;this.typology=a,this.abstract=this.settings.typology[a].abstract,this.units=this.settings.typology[a].units,this.crs=i.crs,this.typology=="CHL"?this.legend=pi:this.typology=="TSM"?this.legend=mi:this.legend=hi,this.to=r[0],this.tf=r[r.length-1],this.datesList=this.layer_list.time[s].timeFormatted,this.currentDate=this.datesList[Object.keys(this.datesList).length-1],this.currentDateIndex=Object.keys(this.datesList).length,this.datesListLength=Object.keys(this.datesList).length,this.currentGroup=Object.keys(this.layer_list.time).indexOf(s)}$(".metadata-panel").addClass("active"),$(".metadata-panel").css("display","block"),e=="time"&&($(".time-panel").addClass("active"),$(".time-panel").css("display","block"),$(".show-metadata").addClass("active"),$(".show-time").addClass("active"))},downloadData(){}},async mounted(){this.basemap_settings=this.settings.basemaps,at.get(this.settings.urlWMSget).then(t=>{let s=yi.read(t.data).Capability.Layer.Layer,i=Ct(s,this.settings.typology,this.settings.urlWMS);It(i);let a=je(i);this.layer_list=i,this.layer_group=a;let r={};for(let[c,d]of Object.entries(i.time)){let u=c.split("_").splice(0,2).join("_");u in Object.keys(r)||(r[u]=d)}return this.layer_list.time=r,r=this.layer_list,{layers_groups_reduced:je(r),layers_dict_reduced:r}}).then(t=>{const e=t.layers_groups_reduced,s=t.layers_dict_reduced,i=xt();for(let f in e)for(let L in e[f])i.addLayer(e[f][L]);this.map=i;const a=document.getElementById("popup"),r=document.getElementById("popup-title"),n=document.getElementById("popup-coordinate"),c=document.getElementById("popup-getinfo"),d=document.getElementById("popup-closer"),u=document.getElementById("plotPanel"),x=new it({element:a,autoPan:{animation:{duration:250}}});d.onclick=function(){return x.setPosition(void 0),d.blur(),!1},i.addControl(x);const F=this.map.getView().getResolution();i.on("singleclick",function(f){const L=f.coordinate,P=nt(rt(L));n.innerHTML="<p>Coordinate: </p><code>"+P+"</code>",x.setPosition(L);const K=i.getEventPixel(f.originalEvent);let C={values:[],typology:""};this.noGetinfo=0,i.forEachLayerAtPixel(K,function(A,le){if(A.title!="basemap"){var G=A.values_.source.getFeatureInfoUrl(f.coordinate,F,"EPSG:3857",{INFO_FORMAT:"application/json"}),G="https://www.webgis.eo.simile.polimi.it/api/getLayerInfo?"+G.split("/")[G.split("/").length-1].split("?")[1];let Y=document.querySelector(".time-select-group").selectedIndex,se=document.querySelector(".time-select-group").options[Y].text+"_IT";if(G){const me=new Request(G);if(fetch(me).then(B=>B.json()).then(B=>{A.name==se&&(c.innerHTML="<p>Value: </p><code>"+B.data.features["0"].properties.GRAY_INDEX.toFixed(2)+" "+A.units+"</code>",r.innerHTML="<p>"+A.name.split("_").splice(0,2).join("_")+":"+A.date+"</p>")}),u.classList.contains("active")&&A.name==se){let B=A.name.split("_").splice(0,2).join("_");A.name.split("_")[2],s[A.title][B].layer.forEach(ce=>{var R=ce.values_.source.getFeatureInfoUrl(f.coordinate,F,"EPSG:3857",{INFO_FORMAT:"application/json"}),R="https://www.webgis.eo.simile.polimi.it/api/getLayerInfo?"+R.split("/")[R.split("/").length-1].split("?")[1];let b=fetch(R).then(H=>H.json()).then(H=>{let M=H.data.features[0];if(M!=null){let W=M.properties.GRAY_INDEX;if(W!=null&&W>0)return{month:ce.date.toString(),count:Number(W.toFixed(2))}}});C.values.push(b)}),C.typology=s[A.title][B].typology,document.getElementById("metric-modal").innerHTML='<div class="wait-message"><div class="loader"></div><div class="wait-message-text"><p>Plotting time series, please wait...</p></div></div>',St(C)}else document.getElementById("metric-modal").innerHTML=""}}else c.innerHTML="<p>Value: </p><code>N/A</code>",r.innerHTML="Click on a layer"})}),i.on("pointermove",function(f){if(f.dragging)return;const L=i.getEventPixel(f.originalEvent),P=i.forEachLayerAtPixel(L,function(K,C){if(K.title!="basemap")return!0});i.getTargetElement().style.cursor=P?"pointer":""}),ut(a),this.isLoading=!1}).catch(t=>console.log("No layers have been found in the site url"))}},_i=l("div",{id:"map",class:"map"},null,-1);function vi(t,e,s,i,a,r){const n=D("layerPanel"),c=D("metadataPanel"),d=D("timePanel"),u=D("basemapPanel"),x=D("slidePanel"),w=D("plotPanel"),F=D("popUp"),f=D("loading-screen");return p(),v("div",null,[_i,V(n,{child_msg:"Layer-Panel",layer_list:a.layer_list,onSetLayerVisible:r.setLayerVisible,onSetLayerOpacity:r.setLayerOpacity,onSetLayerMetadata:r.setLayerMetadata},null,8,["layer_list","onSetLayerVisible","onSetLayerOpacity","onSetLayerMetadata"]),V(c,{child_msg:"Metadata-Panel",settings:s.settings,title:a.title,abstract:a.abstract,to:a.to,tf:a.tf,typology:a.typology,units:a.units,crs:a.crs,legend:a.legend},null,8,["settings","title","abstract","to","tf","typology","units","crs","legend"]),V(d,{child_msg:"Time-Panel",title:a.title,datesList:a.datesList,datesListLength:a.datesListLength,currentDate:a.currentDate,currentDateIndex:a.currentDateIndex,currentGroup:a.currentGroup,currentGroupIndex:a.currentGroupIndex,isLayerActive:a.isLayerActive,activeLayersList:a.activeLayersList,onUpdateGroupDropdown:r.updatedDropdown,onUpdateLayerSlider:r.setLayerVisibleTS,onUpdateLayerDropdown:r.setLayerVisibleTS,onStepBackwards:r.setLayerVisibleTS,onStepForwards:r.setLayerVisibleTS},null,8,["title","datesList","datesListLength","currentDate","currentDateIndex","currentGroup","currentGroupIndex","isLayerActive","activeLayersList","onUpdateGroupDropdown","onUpdateLayerSlider","onUpdateLayerDropdown","onStepBackwards","onStepForwards"]),V(u,{child_msg:"Basemap-Panel",data:a.basemap_settings,layer_list:a.layer_list,onSetLayerVisible:r.setLayerVisible},null,8,["data","layer_list","onSetLayerVisible"]),V(x,{child_msg:"Slide-Panel",settings:s.settings},null,8,["settings"]),V(w,{child_msg:"Plot-Panel  (Single-click on map to plot the WQP estimates time series)"},null,8,["child_msg"]),V(F,{map:a.map,title:a.title,evtCoordinate:"click-on map",pixelCoordinate:"select a pixel",pixelInfo:"click-on map",pixelUnits:"select a pixel"},null,8,["map","title"]),V(f,{isLoading:a.isLoading},null,8,["isLoading"])])}var fi=E(gi,[["render",vi]]);const bi={name:"App",data(){return{settings:We}},components:{WebGISContainer:fi}};function Ai(t,e,s,i,a,r){const n=D("WebGISContainer");return p(),Le(n,{settings:a.settings},null,8,["settings"])}var Li=E(bi,[["render",Ai],["__scopeId","data-v-7031f9ca"]]);lt(Li).mount("#app");
//# sourceMappingURL=index.5a62a855.js.map
