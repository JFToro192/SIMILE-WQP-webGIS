import{C as w,O as Me,a as He,T as se,M as Je,d as Xe,S as qe,V as ze,W as Pe,b as Ne,L as fe,c as Ke,o as h,e as b,f as D,t as p,g as l,F as ae,r as ne,p as q,h as z,n as re,i as Ve,j as be,w as Ae,k as Re,v as Ue,l as Ze,m as M,q as Y,s as et,u as tt,x as st,y as at,z as nt}from"./vendor.eedb9b49.js";const rt=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(t){if(t.ep)return;t.ep=!0;const r=s(t);fetch(t.href,r)}};rt();var it="/assets/assev_simile.d3f83cf6.png";function lt(){const e="."+this.element.classList[0],a="."+e.split("-")[1]+"-item",s=$(e);s.hasClass("active")?($(`${a}`).slice(0).hide(),s.removeClass("active")):($(`${a}`).slice(0).show(),s.addClass("active"))}function U(){const e="."+this.element.classList[0],a="."+e.split("-")[1]+"-panel",s=$(e),n=$(a);n.hasClass("active")?(n.hide(),s.removeClass("active"),n.removeClass("active")):(n.show(),s.addClass("active"),n.addClass("active"))}class ot extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-list"></i>';const t=document.createElement("div");t.className="show-burger ol-unselectable ol-control control-bar active",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",lt.bind(this),!1)}}class ct extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-stack"></i>',n.title="layers panel";const t=document.createElement("div");t.className="show-layer ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class dt extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-info-square"></i>',n.title="metadata panel";const t=document.createElement("div");t.className="show-metadata ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class ut extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-clock-history"></i>',n.title="time panel";const t=document.createElement("div");t.className="show-time ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class pt extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-map"></i>',n.title="basemaps";const t=document.createElement("div");t.className="show-basemap ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class mt extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-graph-up"></i>',n.title="plot time series";const t=document.createElement("div");t.className="show-plot ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class gt extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<i class="bi bi-file-earmark-easel"></i>',n.title="webgis guide";const t=document.createElement("div");t.className="show-slide ol-unselectable ol-control control-bar burger-item",t.appendChild(n);super({element:t,target:s.target});t.addEventListener("click",U.bind(this),!1)}}class _t extends w{constructor(a){const s=a||{},n=document.createElement("button");n.innerHTML='<a href="https://www.geonode.eo.simile.polimi.it/"><i class="bi bi-people-fill"></i></a>',n.src=n.title="GeoNode";const t=document.createElement("div");t.className="show-geonode ol-unselectable ol-control control-bar",t.appendChild(n);super({element:t,target:s.target})}}class yt extends w{constructor(a){const s=a||{},n=document.createElement("div"),t=document.createElement("a");t.href="https://www.progetti.interreg-italiasvizzera.eu/it/b/78/sistemainformativoperilmonitoraggiointegratodeilaghiinsubriciedeiloroe";const r=document.createElement("img");r.src=it,r.alt="logo-simile-interreg",t.appendChild(r),n.appendChild(t);const i=document.createElement("div");i.className="project-logo ol-unselectable ol-control",i.appendChild(n);super({element:i,target:s.target})}}const ht=new Me,vt=new He({layers:[new se({source:ht})]});function ft(){return new Je({target:"map",controls:Xe().extend([new qe,vt,new ot,new ct,new dt,new ut,new pt,new mt,new gt,new yt,new _t]),view:new ze({center:[994904.36016,5775887605341e-6],zoom:10})})}new w({element:document.getElementById("layerPanel")});new w({element:document.getElementById("metadataPanel")});new w({element:document.getElementById("timePanel")});new w({element:document.getElementById("basemapPanel")});new w({element:document.getElementById("plotPanel")});new w({element:document.getElementById("slidePanel")});new w({element:document.getElementById("popup")});const ke={urlWMS:"https://www.geonode.eo.simile.polimi.it/geoserver/geonode/wms",urlWMSget:"https://www.webgis.eo.simile.polimi.it/api/getLayers",urlWMSfeatureInfo:"https://www.webgis.eo.simile.polimi.it/api/getLayerInfo",typology:{CHL:{title:"Chlorophyll-a",abstract:"Chlorophyll-a allows plants to photosintezise. This measurement is used to classify the trophic conditionof a water body. The Chlorophyll-a maps presented have been processed using the Sentinel-3 OLCI sensor",style:"chl",units:"mg/m3"},TSM:{title:"Total Suspended Matter",abstract:"Total suspended matter concentration",style:"tsm",units:"g/m3"},LSWT:{title:"Lake Surface Water Temperature",abstract:"Average lake surface temperature",style:"lswt",units:"\xB0C"}},basemaps:[{layer:"osm",source:"osm",src:"osm.png",active:!0},{layer:"terrain",source:"terrain-labels",src:"terrain.png",active:!1},{layer:"toner",source:"toner",src:"toner.png",active:!1},{layer:"none",source:"none",src:"none.png",active:!1}],slides:[{title:"Welcome!",src:"i1.png",description:"1. SIMILE WebGIS enables the visualization of the water quality parameters (WQPs) maps produced for Lakes Maggiore, Lugano and Como."},{title:"Explore the different tools",src:"i2.png",description:"2. The WebGIS presents multtiple panels allowing to explore the different water quality parameters maps"},{title:"Visualize and explore the WQP",src:"i3.png",description:"3. Review the different components allowing the visualization of the maps, such as the layer panel, metadata panel and time controller"},{title:"Observe the evolution of the time series",src:"i4.png",description:"4. Use the time manager to observe the changes of the parameters in time."},{title:"Observe the evolution of the time series",src:"i5.png",description:"4. Use the time manager to observe the changes of the parameters in time."},{title:"Change the basemap",src:"i6.png",description:"5. Customize the view of the WebGIS by using different basemaps"},{title:"Explore the guide",src:"i7.png",description:"6. Review the guide for the WebGIS"}]};function bt(e,a){var s=600,n=400,t=ke.typology[a],r=e;r.forEach(function(o){o.month=d3.time.format("%Y-%m-%d").parse(o.month)}),r.sort(function(o,m){return d3.ascending(o.month,m.month)});var i={top:20,right:30,bottom:100,left:20},c=s-i.left-i.right+100,d=n-i.top-i.bottom,u={top:320,right:30,bottom:20,left:14},P=n-u.top-u.bottom,A=d3.extent(r,function(o){return o.month}),x=[0,d3.max(r,function(o){return o.count})],L=A[0],C=A[1],E=d3.time.format("%b %Y"),F=Qe([[d3.time.format("%Y"),function(){return!0}],[d3.time.format("%b %Y"),function(o){return o.getMonth()}],[function(){return""},function(o){return o.getDate()!=1}]]),f=d3.time.scale().range([0,c]).domain(A),K=d3.scale.linear().range([d,0]).domain(x),N=d3.svg.axis().scale(f).orient("bottom").tickSize(-d).ticks(Se).tickFormat(F),ie=d3.svg.axis().scale(K).ticks(4).tickSize(-c).orient("right"),T=d3.time.scale().range([0,c]).domain([L,C]),me=d3.scale.linear().range([P,0]).domain(K.domain()),G=d3.svg.axis().scale(T).orient("bottom").ticks(Se).tickFormat(F),W=d3.svg.line().x(function(o){return f(o.month)}).y(function(o){return K(o.count)}),Z=d3.svg.area().x(function(o){return f(o.month)}).y0(d).y1(function(o){return K(o.count)}),ee=d3.svg.area().x(function(o){return T(o.month)}).y0(P).y1(function(o){return me(o.count)}),le=d3.svg.line().x(function(o){return T(o.month)}).y(function(o){return me(o.count)}),v=d3.svg.brush().x(T).on("brush",Ie).on("brushend",Ee),oe=d3.behavior.zoom().on("zoom",ye).on("zoomend",Ee),H=d3.select("#metric-modal").append("svg").attr("width",c+i.left+i.right).attr("height",d+i.top+i.bottom).attr("class","metric-chart");H.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",c).attr("height",d);var ce=H.append("g").attr("class","context").attr("transform","translate("+u.left+","+u.top+")"),S=H.append("g").attr("class","focus").attr("transform","translate("+i.left+","+i.top+")");H.append("svg:rect").attr("class","pane").attr("width",c).attr("height",d).attr("transform","translate("+i.left+","+i.top+")").call(oe).call(ye);var de=H.append("g").attr("id","buttons_group").attr("transform","translate("+0+","+0+")");de.append("text").text("Time series between: ").style("text-anchor","start").attr("transform","translate("+0+","+10+")"),de.append("text").attr("id","displayDates").text(E(A[0])+" - "+E(A[1])).style("text-anchor","start").attr("transform","translate("+135+","+10+")"),de.append("text").text("Zoom to: ").style("text-anchor","start").attr("transform","translate("+270+","+10+")");var ge=40,xe=14,Oe=A[1]-A[0],Ye=3154e7;if(Oe<Ye)var Le=["month","data"];else var Le=["year","month","data"];var Ce=de.selectAll("g").data(Le).enter().append("g").attr("class","scale_button").attr("transform",function(o,m){return"translate("+(330+m*ge+m*10)+",0)"}).on("click",$e);Ce.append("rect").attr("width",ge).attr("height",xe).attr("rx",1).attr("ry",1),Ce.append("text").attr("dy",xe/2+3).attr("dx",ge/2).style("text-anchor","middle").text(function(o){return o}),S.append("g").attr("class","y axis").call(ie).attr("transform","translate("+c+", 0)"),S.append("path").datum(r).attr("class","area").attr("d",Z),S.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(N),S.append("path").datum(r).attr("class","line").attr("d",W),ce.append("path").datum(r).attr("class","area").attr("d",ee),ce.append("path").datum(r).attr("class","line").attr("d",le),ce.append("g").attr("class","x axis").attr("transform","translate(0,"+P+")").call(G);var _e=ce.append("g").attr("class","x brush").call(v);_e.selectAll(".extent").attr("y",-6).attr("height",P+8),_e.selectAll(".resize").append("rect").attr("class","handle").attr("transform","translate(0,"+-3+")").attr("rx",2).attr("ry",2).attr("height",P+6).attr("width",3),_e.selectAll(".resize").append("rect").attr("class","handle-mini").attr("transform","translate(-2,8)").attr("rx",3).attr("ry",3).attr("height",P/2).attr("width",7),H.append("text").attr("class","y axis title").text(`${a} [${t.units}]`).attr("x",-(d/2)).attr("y",0).attr("dy","1em").attr("transform","rotate(-90)").style("text-anchor","middle"),oe.x(f);function Qe(o){return function(m){for(var g=o.length-1,y=o[g];!y[1](m);)y=o[--g];return y[0](m)}}function Se(o,m,g){var y=42,B=Math.floor(c/y);function V(X,he){X.setMonth(X.getMonth()+he)}for(var J=d3.time.month.ceil(o),j=[],O=[1,3,4,12];J<m;)j.push(new Date(+J)),V(J,1);var ue=j,te;for(te=0;j.length>B;te++)j=_.filter(ue,function(X){return X.getMonth()%O[te]==0});return j}function Ie(){f.domain(v.empty()?T.domain():v.extent()),S.select(".area").attr("d",Z),S.select(".line").attr("d",W),S.select(".x.axis").call(N),oe.x(f),Be(),De()}function ye(){De(),S.select(".area").attr("d",Z),S.select(".line").attr("d",W),S.select(".x.axis").call(N),v.extent(f.domain()),H.select(".brush").call(v),Be()}function Ee(){var o=v.extent(),m=v.extent().some(function(g){return g<L|g>C});m&&(o=Fe(o))}function Be(){var o=v.extent(),m=v.empty()?E(A[0]):E(o[0]),g=v.empty()?E(A[1]):E(o[1]);d3.select("#displayDates").text(m==g?m:m+" - "+g)}function Fe(o){var m=31536e6,g,y;return o[0]<L?g=L:o[0]>C?g=new Date(C.getTime()-m):g=o[0],o[1]>C?y=C:o[1]<L?y=new Date(L.getTime()+m):y=o[1],v.extent([g,y]),v(d3.select(".brush").transition()),Ie(),ye(),v.extent()}function De(){var o=new Date(f.domain()[0]),m=new Date(f.domain()[1]),g=d3.bisector(function(R){return R.month}).right,y=g(r,o);if(r[y]!==void 0&&r[y-1]!==void 0)var B=r[y-1].month,V=r[y].month,J=d3.interpolateNumber(r[y-1].count,r[y].count),j=J((o-B)/(V-B));else var j=0;var O=g(r,m);if(r[O]!==void 0&&r[O-1]!==void 0)var ue=r[O-1].month,te=r[O].month,J=d3.interpolateNumber(r[O-1].count,r[O].count),X=J((m-ue)/(te-ue));else var X=0;var he=r.filter(function(R){return R.month>=o&&R.month<=m}),pe=[];he.map(function(R){pe.push(R.count)}),pe.push(j),pe.push(X);var ve=d3.max(pe);ve==0&&(ve=x[1]),K.domain([0,ve*1.05]),S.select(".y.axis").call(ie)}function $e(o,m){var g=v.extent(),y,B,V;o=="year"?y=31536e6:o=="month"&&(y=2592e6),o=="year"|o=="month"?C.getTime()-g[1].getTime()<y?(V=new Date(C.getTime()-y),B=C):(V=g[0],B=new Date(g[0].getTime()+y)):o=="data"?(V=A[0],B=A[1]):(V=g[0],B=g[1]),v.extent([V,B]),v(d3.select(".brush").transition()),v.event(d3.select(".brush").transition())}}new Pe;function we(e,a,s,n){return new se({source:new Ke({url:a,params:{LAYERS:e,TILED:!0,STYLES:n},serverType:"geoserver"}),visible:!1,opacity:s})}function Te(e,a){return e[a.name]={},e[a.name].workspace=a.workspace,e[a.name].typology=a.typology,e[a.name].crs=a.crs,e[a.name].sensor=a.sensor,e[a.name].timeComplete=[a.timeComplete],e[a.name].timeFormatted=[a.timeFormatted],e[a.name].level=a.level,e[a.name].layer=[a.layer],e}function At(e,a,s){let n=Object.keys(a),t={};return t.static={},t.time={},t.basemap={},e.forEach(r=>{let i={},c=r.Name.split(":");if(i.workspace=c[0],i.name=c[1].split("_").slice(0,3).join("_"),i.sensor=c[1].split("_")[0],i.typology=c[1].split("_")[1],i.crs=c[1].split("_")[2],c[1].split("_")[3]!=null){i.timeComplete=c[1].split("_")[3];let u=c[1].split("_")[3].split("T")[0];i.timeFormatted=u.slice(0,4)+"-"+u.slice(4,6)+"-"+u.slice(6,8)}else i.timeComplete=void 0,i.timeFormatted=void 0;i.level=c[1].split("_")[4];let d="";n.includes(i.typology)&&(d=i.typology.toLowerCase()),i.layer=we(r.Name,s,.5,d),i.timeComplete!=null?i.name in t.time?(i.layer=we(r.Name,s,1,d),i.layer.title="time",i.layer.date=i.timeFormatted,i.layer.name=i.name,i.name.split("_")[1]=="LSWT"?i.layer.units="[\xB0C]":i.name.split("_")[1]=="CHL"?i.layer.units="[mg/m3]":i.name.split("_")[1]=="TSM"&&(i.layer.units="[g/m3]"),t.time[i.name].timeComplete.push(i.timeComplete),t.time[i.name].timeFormatted.push(i.timeFormatted),t.time[i.name].layer.push(i.layer)):(i.layer=we(r.Name,s,1),i.layer.title="time",i.layer.name=i.name,i.layer.date=i.timeFormatted,i.name.split("_")[1]=="LSWT"?i.layer.units="[\xB0C]":i.name.split("_")[1]=="CHL"?i.layer.units="[mg/m3]":i.name.split("_")[1]=="TSM"&&(i.layer.units="[g/m3]"),t.time=Te(t.time,i)):t.static=Te(t.static,i)}),t}function wt(e){let a={osm:{title:"osm",layer:[new se({source:new Me,visible:!0})]},terrain:{title:"terrain",source:"Stamen",layer:[new se({source:new Ne({layer:"terrain"}),visible:!1})]},toner:{title:"toner",source:"Stamen",layer:[new se({source:new Ne({layer:"toner"}),visible:!1})]}};return e.basemap=a,e}function Ge(e){let a={},s=[],n=[],t=[],r=[],i=[];for(let c in e)if(c=="time")for(let d in e[c]){let u=e[c][d].layer;i.push(new fe({layers:u,visible:!0,opacity:.5}))}else{for(let d in e[c])if(c=="basemap"){let u=e[c][d].layer[0];u.title="basemap",s.push(u)}else if(c=="static"){let u=e[c][d].layer[0];u.title="static",n.push(u)}r[0]=new fe({layers:n,visible:!0,opacity:1}),t[0]=new fe({layers:s,visible:!0,opacity:1})}return a.basemap=t,a.static=r,a.time=i,a}function xt(e){var a=document.querySelector(".metric-chart");try{a.remove()}catch(s){console.warn("no chart")}Promise.all(e.values).then(s=>{bt(s,e.typology)})}var I=(e,a)=>{const s=e.__vccOpts||e;for(const[n,t]of a)s[n]=t;return s};const Lt={name:"Layer",props:{child_msg:{type:String,default:"Layer Panel"},layer_list:{type:Object}},data(){return{}},methods:{setLayerVisible(e,a,s,n,t){this.$emit("setLayerVisible",{nGroup:a,index:s}),e.target.checked&&this.setLayerMetadata(n,t)},setLayerOpacity(e,a,s){let n=e.target.value;this.$emit("setLayerOpacity",{opacity:n,nGroup:a,index:s})},setLayerMetadata(e,a){this.$emit("setLayerMetadata",{layerType:e,layerName:a})}}},Q=e=>(q("data-v-3b7d1851"),e=e(),z(),e),Ct={id:"layerPanel",class:"layer-panel ol-unselectable ol-control"},St=Q(()=>l("h6",{class:"static-layers-title"},[l("i",{class:"bi bi-arrow-right"}),D("Static Layers")],-1)),It={class:"static-layers active",id:"staticLayers"},Et={class:"layer-items"},Bt=["onChange"],Dt={class:"title-layer"},Mt=["title"],Pt=Q(()=>l("div",{class:"dwnld-layer"},[l("i",{class:"bi bi-box-arrow-down"})],-1)),Nt=["onClick"],Vt=Q(()=>l("i",{class:"bi bi-info-square"},null,-1)),kt=[Vt],Tt=Q(()=>l("div",{class:"opct-layer"},[l("i",{class:"bi bi-brightness-high"})],-1)),Gt={class:"opct-range-layer"},Wt=["onChange"],jt=Q(()=>l("h6",{class:"time-series-layers-title"},[l("i",{class:"bi bi-arrow-right"}),D("Time Series Layers")],-1)),Ot={class:"time-series-layers active",id:"timeSeriesLayers"},Yt={class:"layer-items"},Qt=["onChange"],Ft={class:"title-layer"},$t=["title"],Ht=Q(()=>l("div",{class:"dwnld-layer"},[l("i",{class:"bi bi-box-arrow-down"})],-1)),Jt=["onClick"],Xt=Q(()=>l("i",{class:"bi bi-info-square"},null,-1)),qt=[Xt],zt=Q(()=>l("div",{class:"opct-layer"},[l("i",{class:"bi bi-brightness-high"})],-1)),Kt={class:"opct-range-layer"},Rt=["onChange"];function Ut(e,a,s,n,t,r){return h(),b("div",Ct,[D(p(s.child_msg)+" ",1),St,l("div",It,[(h(!0),b(ae,null,ne(s.layer_list.static,(i,c,d)=>(h(),b("div",{class:"static-layer layer-list",key:i.static},[l("div",Et,[l("div",{class:re("chckbx-layer layer-static-"+d)},[l("input",{type:"checkbox",title:"set visible",name:"",id:"",class:re("layer-static-"+d),onChange:u=>r.setLayerVisible(u,1,d,"static",{key:c})},null,42,Bt)],2),l("div",Dt,[l("p",{title:c},p(c),9,Mt)]),Pt,l("div",{class:"info-layer",onClick:u=>r.setLayerMetadata("static",{key:c})},kt,8,Nt),Tt,l("div",Gt,[l("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.5",onChange:u=>r.setLayerOpacity(u,1,d)},null,40,Wt)])])]))),128))]),jt,l("div",Ot,[(h(!0),b(ae,null,ne(s.layer_list.time,(i,c,d)=>(h(),b("div",{class:"time-series-layer layer-list",key:i.time},[l("div",Yt,[l("div",{class:re("chckbx-layer"+d)},[l("input",{type:"checkbox",title:"set visible",name:"",id:"",class:re("layer-timeSeries-"+d),onChange:u=>r.setLayerVisible(u,2,d,"time",{key:c})},null,42,Qt)],2),l("div",Ft,[l("p",{title:c},p(c),9,$t)]),Ht,l("div",{class:"info-layer",onClick:u=>r.setLayerMetadata("time",{key:c})},qt,8,Jt),zt,l("div",Kt,[l("input",{type:"range",name:"",id:"",min:"0",max:"1",step:"0.01",value:"0.5",onChange:u=>r.setLayerOpacity(u,2,d)},null,40,Rt)])])]))),128))])])}var Zt=I(Lt,[["render",Ut],["__scopeId","data-v-3b7d1851"]]);const es={name:"Layer",props:{child_msg:{type:String,required:!0,default:"Metadata Panel"},title:{type:String,required:!0,default:"Title"},abstract:{type:String,required:!0,default:"Select a layer"},typology:{type:String,required:!0,default:"N/A"},units:{type:String,required:!0,default:"N/A"},crs:{type:String,required:!0,default:"N/A"},to:{type:String,required:!0,default:"N/A"},tf:{type:String,required:!0,default:"N/A"},legend:{type:String,required:!0,default:"N/A"}},data(){return{}}},k=e=>(q("data-v-cf4a443c"),e=e(),z(),e),ts={id:"metadataPanel",class:"metadata-panel ol-unselectable ol-control"},ss={class:"panel-title"},as={class:"meta-title"},ns={class:"meta-abstract"},rs=k(()=>l("strong",null,"Abstract:",-1)),is={class:"meta-info"},ls={class:"meta-details"},os={class:"meta-details-typology"},cs=k(()=>l("strong",null,"Typology:",-1)),ds={class:"meta-details-units"},us=k(()=>l("strong",null,"Units:",-1)),ps={class:"meta-details-crs"},ms=k(()=>l("strong",null,"CRS:",-1)),gs={class:"meta-details-tstart"},_s=k(()=>l("strong",null,"Time Start:",-1)),ys=k(()=>l("br",null,null,-1)),hs={class:"meta-details-tend"},vs=k(()=>l("strong",null,"Time end:",-1)),fs=k(()=>l("br",null,null,-1)),bs={class:"meta-legend"},As=k(()=>l("div",null,[l("strong",null,"Legend:")],-1)),ws={class:"meta-legend-image"},xs=["src"];function Ls(e,a,s,n,t,r){return h(),b("div",ts,[l("div",ss,p(s.child_msg),1),l("div",as,[l("h6",null,p(s.title),1)]),l("div",ns,[rs,D(p(s.abstract),1)]),l("div",is,[l("div",ls,[l("div",os,[cs,D(p(s.typology),1)]),l("div",ds,[us,D(" ["+p(s.units)+"]",1)]),l("div",ps,[ms,D(p(s.crs),1)]),l("div",gs,[_s,ys,D(p(s.to),1)]),l("div",hs,[vs,fs,D(p(s.tf),1)])]),l("div",bs,[As,l("div",ws,[l("img",{src:s.legend,alt:""},null,8,xs)])])])])}var Cs=I(es,[["render",Ls],["__scopeId","data-v-cf4a443c"]]);const Ss={name:"Time",props:{child_msg:{type:String,default:"Time Panel"},title:{type:String,required:!0,default:"Select Layer"},datesList:{type:Object,required:!0,default:()=>({"0":"Select TS"})},datesListLength:{type:String,required:!0},currentDate:{type:String,required:!0},currentDateIndex:{type:Number,required:!0},currentGroup:{type:Number,required:!0}},data(){return{}},methods:{updateLayerSlider(e){console.log(e);let a=e.target.value,s=parseInt(a),n=this.currentGroup+2,t=document.getElementById("dropdownDate");t.selectedIndex=a,this.cDate=this.datesList[a],this.cDateIndex=a,this.$emit("updateLayerSlider",{nGroup:n,emitDate:s})},updateLayerDropdown(e){let a=e.target.value,s=parseInt(a),n=this.currentGroup+2,t=document.getElementById("sliderDate");t.value=a,this.cDate=this.datesList[a],this.cDateIndex=a,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:s})},stepBackwards(){let e=document.getElementById("sliderDate").value,a=e-1,s=e-1,n=this.currentGroup+2;e-1>=0?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:a})):alert("There are no previous maps for the current layer")},stepForwards(){let e=document.getElementById("dropdownDate").value,a=Number(e)+1,s=Number(e)+1,n=this.currentGroup+2;Number(e)+1<=this.datesListLength-1?(this.cDate=this.datesList[s],this.cDateIndex=s,document.getElementById("dropdownDate").selectedIndex=s,document.getElementById("sliderDate").value=s,this.$emit("updateLayerDropdown",{nGroup:n,emitDate:a})):alert("There are no later maps for the current layer")}}},We=e=>(q("data-v-0b528842"),e=e(),z(),e),Is={id:"timePanel",class:"time-panel ol-unselectable ol-control"},Es={class:"time-container"},Bs={class:"time-header"},Ds={class:"time-controls"},Ms={class:"time-controls-dates"},Ps=["value","selected"],Ns={class:"time-slider"},Vs=["max","value"],ks={id:"time-controls-backward",class:"time-controls_item ol-unselectable ol-control"},Ts=We(()=>l("i",{class:"bi bi-skip-backward-circle"},null,-1)),Gs=[Ts],Ws={id:"time-controls-forward",class:"time-controls_item ol-unselectable ol-control"},js=We(()=>l("i",{class:"bi bi-skip-forward-circle"},null,-1)),Os=[js];function Ys(e,a,s,n,t,r){return h(),b("div",Is,[l("p",null,p(s.child_msg),1),l("div",Es,[l("div",Bs,[l("strong",null,p(s.title),1)]),l("div",Ds,[l("div",Ms,[l("select",{name:"",id:"dropdownDate",onChange:a[0]||(a[0]=i=>r.updateLayerDropdown(i))},[(h(!0),b(ae,null,ne(s.datesList,(i,c)=>(h(),b("option",{value:c,selected:s.datesListLength,key:c},p(s.datesList[c]),9,Ps))),128))],32)]),l("div",Ns,[l("input",{type:"range",name:"",id:"sliderDate",min:"0",max:s.datesListLength-1,value:s.currentDateIndex,step:"1",onChange:a[1]||(a[1]=i=>r.updateLayerSlider(i))},null,40,Vs)]),l("div",ks,[l("button",{class:"time-panel-control-button",onClick:a[2]||(a[2]=(...i)=>r.stepBackwards&&r.stepBackwards(...i))},Gs)]),l("div",Ws,[l("button",{class:"time-panel-control-button",onClick:a[3]||(a[3]=(...i)=>r.stepForwards&&r.stepForwards(...i))},Os)])])])])}var Qs=I(Ss,[["render",Ys],["__scopeId","data-v-0b528842"]]),Fs="/assets/osm.d6d13acb.png",$s="/assets/terrain.d843a7bb.png",Hs="/assets/watercolor.8d0c5f2f.png",Js="/assets/toner.19bbfbf8.png",Xs="data:image/png;base64,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";const qs={name:"Basemap",props:{child_msg:{type:String,default:"Basemap Panel"},data:{type:Array},layer_list:{type:Object,require:!0}},data(){return{}},methods:{getImage(e){if(e=="osm")return Fs;if(e=="terrain")return $s;if(e=="watercolor")return Hs;if(e=="toner")return Js;if(e=="none")return Xs},setLayerVisible(e,a){this.$emit("setLayerVisible",{nGroup:e,index:a})}}},zs={id:"basemapPanel",class:"basemap-panel ol-unselectable ol-control"},Ks={class:"basemap-container"},Rs=["id","checked","onChange"],Us=["src"];function Zs(e,a,s,n,t,r){return h(),b("div",zs,[l("p",null,p(s.child_msg),1),l("div",Ks,[(h(!0),b(ae,null,ne(s.data,(i,c)=>(h(),b("div",{key:i.layer,class:"basemap-container_item"},[l("div",null,[l("input",{type:"radio",name:"basemap-radio",id:i.layer+"-option",class:re("basemap-option"),checked:i.active,onChange:d=>r.setLayerVisible(0,c)},null,40,Rs),l("p",null,p(i.layer),1)]),l("img",{src:r.getImage(i.layer),alt:""},null,8,Us)]))),128))])])}var ea=I(qs,[["render",Zs],["__scopeId","data-v-26d54738"]]);const ta={name:"Plot",props:{child_msg:{type:String,default:"Plot Panel"}},data(){return{}}},sa=e=>(q("data-v-651cd38c"),e=e(),z(),e),aa={id:"plotPanel",class:"plot-panel ol-unselectable ol-control"},na={class:"panel-title"},ra=sa(()=>l("div",{id:"metric-modal"},null,-1));function ia(e,a,s,n,t,r){return h(),b("div",aa,[l("div",na,p(s.child_msg),1),ra])}var la=I(ta,[["render",ia],["__scopeId","data-v-651cd38c"]]),oa="/assets/i1.39c6eac4.png",ca="/assets/i2.52627267.png",da="/assets/i3.e76ce568.png",ua="/assets/i4.df51a994.png",pa="/assets/i5.9255129d.png",ma="/assets/i6.c99fefa1.png",ga="/assets/i7.1425b493.png";const _a={data(){return{}},methods:{prev(){this.$emit("prev")},next(){this.$emit("next")}}},je=e=>(q("data-v-07c985f2"),e=e(),z(),e),ya={class:"carousel-container"},ha=je(()=>l("i",{class:"bi bi-caret-left-fill"},null,-1)),va=[ha],fa=je(()=>l("i",{class:"bi bi-caret-right-fill"},null,-1)),ba=[fa];function Aa(e,a,s,n,t,r){return h(),b("div",ya,[Ve(e.$slots,"default",{},void 0,!0),l("button",{class:"prev",onClick:a[0]||(a[0]=(...i)=>r.prev&&r.prev(...i))},va),l("button",{class:"next",onClick:a[1]||(a[1]=(...i)=>r.next&&r.next(...i))},ba)])}var wa=I(_a,[["render",Aa],["__scopeId","data-v-07c985f2"]]);const xa={props:["visibleSlide","index","direction"],data(){return{}}},La={class:"carousel-slide"};function Ca(e,a,s,n,t,r){return h(),be(Ze,{name:s.direction},{default:Ae(()=>[Re(l("div",La,[Ve(e.$slots,"default",{},void 0,!0)],512),[[Ue,s.visibleSlide===s.index]])]),_:3},8,["name"])}var Sa=I(xa,[["render",Ca],["__scopeId","data-v-664b1638"]]);const Ia={name:"Slide",props:{child_msg:{type:String,default:"Slide Panel"},settings:{type:Object}},data(){return{visibleSlide:0,direction:""}},computed:{slidesLen(){return this.settings.slides.length}},methods:{prev(){this.visibleSlide<=0?this.visibleSlide=this.slidesLen-1:this.visibleSlide--,this.direction="right"},next(){this.visibleSlide>=this.slidesLen-1?this.visibleSlide=0:this.visibleSlide++,this.direction="left"},getImage(e){if(e=="i1.png")return oa;if(e=="i2.png")return ca;if(e=="i3.png")return da;if(e=="i4.png")return ua;if(e=="i5.png")return pa;if(e=="i6.png")return ma;if(e=="i7.png")return ga}},mounted(){},components:{CarouselContainer:wa,CarouselSlide:Sa}},Ea=e=>(q("data-v-339db63c"),e=e(),z(),e),Ba={id:"slidePanel",class:"slide-panel ol-unselectable ol-control",style:{display:"none"}},Da={class:"slidepanel-show"},Ma={class:"slide-title"},Pa={class:"slide-description"},Na=["src","alt"],Va=Ea(()=>l("div",{class:"slide-current"},null,-1));function ka(e,a,s,n,t,r){const i=M("carousel-slide"),c=M("carousel-container");return h(),b("div",Ba,[D(p(s.child_msg)+" ",1),l("div",Da,[Y(c,{onPrev:r.prev,onNext:r.next},{default:Ae(()=>[(h(!0),b(ae,null,ne(s.settings.slides,(d,u)=>(h(),be(i,{key:d,index:u,visibleSlide:t.visibleSlide,direction:t.direction},{default:Ae(()=>[l("div",Ma,p(d.title),1),l("div",Pa,p(d.description),1),l("img",{src:r.getImage(d.src),alt:u},null,8,Na)]),_:2},1032,["index","visibleSlide","direction"]))),128))]),_:1},8,["onPrev","onNext"])]),Va])}var Ta=I(Ia,[["render",ka],["__scopeId","data-v-339db63c"]]);const Ga={setup(){},data:function(){return{}},props:{map:{type:Object,required:!0},title:{type:String,required:!0,default:"Select layer"},evtCoordinate:{type:String,required:!0,default:"Select layer"},pixelCoordinate:{type:String,required:!0,default:"click-on map"},pixelInfo:{type:String,required:!0,default:"N/A"},pixelUnits:{type:String,required:!0,default:"N/A"}}},Wa=e=>(q("data-v-3ecc9474"),e=e(),z(),e),ja={id:"popup",class:"ol-popup"},Oa={id:"popup-title"},Ya=Wa(()=>l("a",{href:"#",id:"popup-closer",class:"ol-popup-closer"},null,-1)),Qa={id:"popup-info"},Fa={id:"popup-getinfo"},$a={id:"popup-coordinate"};function Ha(e,a,s,n,t,r){return h(),b("div",ja,[l("div",Oa,p(s.title),1),Ya,l("div",Qa,[l("div",Fa,"Value: "+p(s.pixelInfo)+" "+p(s.pixelUnits),1),l("div",$a,"Coordinates: "+p(s.pixelCoordinate),1)])])}var Ja=I(Ga,[["render",Ha],["__scopeId","data-v-3ecc9474"]]),Xa="/assets/chl_legend.60bb7d0f.png",qa="/assets/tsm_legend.d3624ad5.png",za="/assets/lswt_legend.56275681.png";const Ka=new Pe,Ra={name:"WebGISContainer",data(){return{basemap_settings:this.settings.basemaps,urlLayerInfo:this.settings.urlWMSLayerInfo,layer_list:{},layer_groups:{},map:{},title:"Select a Layer",typology:"N/A",abstract:"N/A",to:"N/A",tf:"N/A",crs:"N/A",units:"N/A",legend:"N/A",datesList:{},currentGroup:0,currentDate:"",currentDateIndex:0,datesListLength:"",noGetinfo:0}},props:{settings:{type:Object,required:!0}},components:{layerPanel:Zt,metadataPanel:Cs,timePanel:Qs,basemapPanel:ea,plotPanel:la,slidePanel:Ta,popUp:Ja},methods:{setLayerVisible(e){let a=e.index,s=e.nGroup;if(s==0){let n=this.map.getLayers().array_[s].values_.layers.array_;n.forEach((t,r)=>{a!=r||n.length<a?t.setVisible(!1):t.setVisible(!0)})}else if(s==1){let n=this.map.getLayers().array_[s].values_.layers.array_[a].getVisible();this.map.getLayers().array_[s].values_.layers.array_[a].setVisible(!n)}else{let t=this.map.getLayers().array_[s+a].values_.layers.array_.length-1,r=this.map.getLayers().array_[s+a].values_.layers.array_,i=0;r.forEach((c,d)=>{let u=this.map.getLayers().array_[s+a].values_.layers.array_[d].getVisible();if(c.getVisible()==!0&&d!=t)return this.map.getLayers().array_[s+a].values_.layers.array_[d].setVisible(!u),i++,!1;i==0&&d==t&&(this.map.getLayers().array_[s+a].values_.layers.array_[t].setVisible(!u),this.currentDate=c.date)})}},setLayerVisibleTS(e){let a=e.nGroup,s=e.emitDate;this.map.getLayers().array_[a].values_.layers.array_.forEach((t,r)=>{s==r?t.setVisible(!0):t.setVisible(!1)})},setLayerOpacity(e){let a=e.opacity,s=e.index,n=e.nGroup;if(n<=1)this.map.getLayers().array_[n].values_.layers.array_[s].getVisible()==!0?(this.map.getLayers().array_[n].values_.layers.array_[s].setVisible(!1),this.map.getLayers().array_[n].values_.layers.array_[s].values_.opacity=a,this.map.getLayers().array_[n].values_.layers.array_[s].setVisible(!0)):this.map.getLayers().array_[n].values_.layers.array_[s].values_.opacity=a;else{let t=this.map.getLayers().array_[n+s];t.getVisible()==!0?(t.setVisible(!1),t.values_.opacity=a,t.setVisible(!0)):t.values_.opacity=a}},setLayerMetadata(e){let a=e.layerType,s=e.layerName.key,n=this.layer_list[a][s];if(this.title=s,a=="time"){let t=n.typology,r=n.timeFormatted;this.typology=t,this.abstract=this.settings.typology[t].abstract,this.units=this.settings.typology[t].units,this.crs=n.crs,this.typology=="CHL"?this.legend=Xa:this.typology=="TSM"?this.legend=qa:this.legend=za,this.to=r[0],this.tf=r[r.length-1],this.datesList=this.layer_list.time[s].timeFormatted,this.currentDate=this.datesList[Object.keys(this.datesList).length-1],this.currentDateIndex=Object.keys(this.datesList).length,this.datesListLength=Object.keys(this.datesList).length,this.currentGroup=Object.keys(this.layer_list.time).indexOf(s)}$(".metadata-panel").addClass("active"),$(".metadata-panel").css("display","block"),a=="time"&&($(".time-panel").addClass("active"),$(".time-panel").css("display","block"),$(".show-metadata").addClass("active"),$(".show-time").addClass("active"))},downloadData(){}},mounted(){this.basemap_settings=this.settings.basemaps,et.get(this.settings.urlWMSget).then(e=>{let s=Ka.read(e.data).Capability.Layer.Layer,n=At(s,this.settings.typology,this.settings.urlWMS);wt(n);let t=Ge(n);this.layer_list=n,this.layer_group=t;let r={};for(let[c,d]of Object.entries(n.time)){let u=c.split("_").splice(0,2).join("_");u in Object.keys(r)||(r[u]=d)}return this.layer_list.time=r,r=this.layer_list,{layers_groups_reduced:Ge(r),layers_dict_reduced:r}}).then(e=>{const a=e.layers_groups_reduced,s=e.layers_dict_reduced,n=ft();for(let x in a)for(let L in a[x])n.addLayer(a[x][L]);this.map=n;const t=document.getElementById("popup"),r=document.getElementById("popup-title"),i=document.getElementById("popup-coordinate"),c=document.getElementById("popup-getinfo"),d=document.getElementById("popup-closer"),u=new tt({element:t,autoPan:{animation:{duration:250}}});d.onclick=function(){return u.setPosition(void 0),d.blur(),!1},n.addControl(u);const A=this.map.getView().getResolution();n.on("singleclick",function(x){const L=x.coordinate,C=st(at(L));i.innerHTML="<p>Coordinate: </p><code>"+C+"</code>",u.setPosition(L);const E=n.getEventPixel(x.originalEvent);let F={values:[],typology:""};this.noGetinfo=0,n.forEachLayerAtPixel(E,function(f,K){if(f.title!="basemap"){var N=f.values_.source.getFeatureInfoUrl(x.coordinate,A,"EPSG:3857",{INFO_FORMAT:"application/json"}),N="https://www.webgis.eo.simile.polimi.it/api/getLayerInfo?"+N.split("/")[N.split("/").length-1].split("?")[1];if(N){const ie=new Request(N);fetch(ie).then(G=>G.json()).then(G=>{c.innerHTML="<p>Value: </p><code>"+G.data.features["0"].properties.GRAY_INDEX.toFixed(2)+" "+f.units+"</code>",r.innerHTML="<p>"+f.name.split("_").splice(0,2).join("_")+":"+f.date+"</p>"});let T=f.name.split("_").splice(0,2).join("_");f.name.split("_")[2],s[f.title][T].layer.forEach(G=>{var W=G.values_.source.getFeatureInfoUrl(x.coordinate,A,"EPSG:3857",{INFO_FORMAT:"application/json"}),W="https://www.webgis.eo.simile.polimi.it/api/getLayerInfo?"+W.split("/")[W.split("/").length-1].split("?")[1];let Z=fetch(W).then(ee=>ee.json()).then(ee=>{let le=ee.data.features[0];if(le!=null){let v=le.properties.GRAY_INDEX;if(v!=null)return{month:G.date.toString(),count:Number(v.toFixed(2))}}});F.values.push(Z)}),F.typology=s[f.title][T].typology,xt(F)}}else c.innerHTML="<p>Value: </p><code>N/A</code>",r.innerHTML="Click on a layer"})}),n.on("pointermove",function(x){if(x.dragging)return;const L=n.getEventPixel(x.originalEvent),C=n.forEachLayerAtPixel(L,function(E,F){if(E.title!="basemap")return!0});n.getTargetElement().style.cursor=C?"pointer":""})}).catch(e=>console.log("No layers have been found in the site url"))}},Ua=l("div",{id:"map",class:"map"},null,-1);function Za(e,a,s,n,t,r){const i=M("layerPanel"),c=M("metadataPanel"),d=M("timePanel"),u=M("basemapPanel"),P=M("slidePanel"),A=M("plotPanel"),x=M("popUp");return h(),b("div",null,[Ua,Y(i,{child_msg:"Layer-Panel",layer_list:t.layer_list,onSetLayerVisible:r.setLayerVisible,onSetLayerOpacity:r.setLayerOpacity,onSetLayerMetadata:r.setLayerMetadata},null,8,["layer_list","onSetLayerVisible","onSetLayerOpacity","onSetLayerMetadata"]),Y(c,{child_msg:"Metadata-Panel",settings:s.settings,title:t.title,abstract:t.abstract,to:t.to,tf:t.tf,typology:t.typology,units:t.units,crs:t.crs,legend:t.legend},null,8,["settings","title","abstract","to","tf","typology","units","crs","legend"]),Y(d,{child_msg:"Time-Panel",title:t.title,datesList:t.datesList,datesListLength:t.datesListLength,currentDate:t.currentDate,currentDateIndex:t.currentDateIndex,currentGroup:t.currentGroup,onUpdateLayerSlider:r.setLayerVisibleTS,onUpdateLayerDropdown:r.setLayerVisibleTS,onStepBackwards:r.setLayerVisibleTS,onStepForwards:r.setLayerVisibleTS},null,8,["title","datesList","datesListLength","currentDate","currentDateIndex","currentGroup","onUpdateLayerSlider","onUpdateLayerDropdown","onStepBackwards","onStepForwards"]),Y(u,{child_msg:"Basemap-Panel",data:t.basemap_settings,layer_list:t.layer_list,onSetLayerVisible:r.setLayerVisible},null,8,["data","layer_list","onSetLayerVisible"]),Y(P,{child_msg:"Slide-Panel",settings:s.settings},null,8,["settings"]),Y(A,{child_msg:"Plot-Panel"}),Y(x,{map:t.map,title:t.title,evtCoordinate:"click-on map",pixelCoordinate:"select a pixel",pixelInfo:"click-on map",pixelUnits:"select a pixel"},null,8,["map","title"])])}var en=I(Ra,[["render",Za]]);const tn={name:"App",data(){return{settings:ke}},components:{WebGISContainer:en}};function sn(e,a,s,n,t,r){const i=M("WebGISContainer");return h(),be(i,{settings:t.settings},null,8,["settings"])}var an=I(tn,[["render",sn],["__scopeId","data-v-5b99cd36"]]);nt(an).mount("#app");
//# sourceMappingURL=index.dd662018.js.map
